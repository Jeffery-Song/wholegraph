succeed=True
[CUDA] cuda: usage: 5.29 GB
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 140248 rows, 21780 columns and 352640 nonzeros
Model fingerprint: 0x3f75baa2
Variable types: 9 continuous, 21771 integer (21771 binary)
Coefficient statistics:
  Matrix range     [5e-09, 2e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 187998.63582
Presolve removed 118958 rows and 7 columns
Presolve time: 0.41s
Presolved: 21290 rows, 21773 columns, 102774 nonzeros
Variable types: 1 continuous, 21772 integer (21771 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.15s

Solved with primal simplex

Root relaxation: objective 1.100781e+04, 2395 iterations, 0.48 seconds (0.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11007.8147    0 10985 187998.636 11007.8147  94.1%     -    1s
H    0     0                    187824.70531 11007.8147  94.1%     -    1s
H    0     0                    187782.15653 11007.8147  94.1%     -    1s
H    0     0                    186785.70197 11007.8147  94.1%     -    3s
H    0     0                    129319.05255 11007.8147  91.5%     -    3s
H    0     0                    112895.98325 11007.8147  90.2%     -    3s
H    0     0                    107187.08774 11007.8147  89.7%     -    3s
     0     0 12332.6936    0 9193 107187.088 12332.6936  88.5%     -    8s
H    0     0                    106956.18714 12332.6936  88.5%     -    9s
H    0     0                    92504.789828 12332.6936  86.7%     -    9s
     0     0 13404.5077    0 7566 92504.7898 13404.5077  85.5%     -    9s
     0     0 13425.5480    0 7545 92504.7898 13425.5480  85.5%     -   10s
H    0     0                    90266.833305 14119.2246  84.4%     -   12s
     0     0 14119.2246    0 7653 90266.8333 14119.2246  84.4%     -   12s
H    0     0                    76342.370818 14119.2246  81.5%     -   12s
H    0     0                    76298.531911 14119.2246  81.5%     -   12s
     0     0 14690.8724    0 7642 76298.5319 14690.8724  80.7%     -   13s
     0     0 14848.5461    0 8135 76298.5319 14848.5461  80.5%     -   13s
     0     0 16087.1332    0 6246 76298.5319 16087.1332  78.9%     -   15s
     0     0 16847.5951    0 6114 76298.5319 16847.5951  77.9%     -   16s
H    0     0                    71739.045166 17009.6799  76.3%     -   17s
H    0     0                    68134.466218 17009.6799  75.0%     -   17s
     0     0 17009.6799    0 6566 68134.4662 17009.6799  75.0%     -   17s
     0     0 17046.0835    0 6627 68134.4662 17046.0835  75.0%     -   18s
     0     0 17047.3469    0 6687 68134.4662 17047.3469  75.0%     -   18s
H    0     0                    63731.610942 17047.3469  73.3%     -   20s
H    0     0                    62954.908428 18510.0527  70.6%     -   22s
     0     0 18510.0527    0 2583 62954.9084 18510.0527  70.6%     -   22s
H    0     0                    33183.343407 18510.0527  44.2%     -   22s
H    0     0                    19433.611818 18510.0527  4.75%     -   23s

Cutting planes:
  Gomory: 204
  Lift-and-project: 19
  MIR: 51
  Flow cover: 14
  Zero half: 3970
  Mod-K: 756

Explored 1 nodes (61462 simplex iterations) in 23.62 seconds (22.41 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 19433.6 33183.3 62954.9 ... 92504.8

Optimal solution found (tolerance 5.00e-02)
Best objective 1.943361181754e+04, best bound 1.851005272347e+04, gap 4.7524%
coll_cache:optimal_local_rate=0.250753,0.225416,0.230562,0.247289,0.254218,0.25578,0.223566,0.22183,
coll_cache:optimal_remote_rate=0.678388,0.703726,0.69858,0.681853,0.674923,0.673361,0.705576,0.707311,
coll_cache:optimal_cpu_rate=0.0708584,0.0708584,0.0708584,0.0708584,0.0708584,0.0708584,0.0708584,0.0708584,
z=19433.6
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.004375 | send           0.000000
        L1  recv             0.000000 | copy           0.014469 | convert time 0.000000 | train  0.008716
        L1  feature nbytes  563.37 MB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes      44.33 MB | remote nbytes  385.56 MB
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.014469
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.001085 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.013319 | cache combine cache 0.001961 | cache combine remote 0.004022
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.014233
        p90.00_tail_logl2featcopy=0.015835
        p95.00_tail_logl2featcopy=0.015997
        p99.00_tail_logl2featcopy=0.016236
        p99.90_tail_logl2featcopy=0.022760
[CUDA] cuda: usage: 16.52 GB
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007658, per step: 0.000061
presamping
presamping takes 13.232665777206421
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004858, per step: 0.000039
presamping
presamping takes 12.404068946838379
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007698, per step: 0.000062
presamping
presamping takes 12.535178899765015
config:eval_tsp="2023-04-14 19:21:19"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=ogbn-papers100M
config:epochs=4
config:batchsize=2000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.12
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=172
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7f731c332400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004677, per step: 0.000037
epoch=4 total_steps=500
presamping
presamping takes 13.002362251281738
start training...
[Epoch 0], time=4.944768905639648, loss=0.6931472420692444
[Epoch 1], time=3.4465155601501465, loss=0.6931472420692444
[Epoch 2], time=3.438973903656006, loss=0.6931472420692444
[Epoch 3], time=3.4769229888916016, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   76740 KB |  418152 KB |  645685 MB |  645610 MB |
|       from large pool |   69734 KB |  411711 KB |  637533 MB |  637464 MB |
|       from small pool |    7006 KB |    8907 KB |    8152 MB |    8145 MB |
|---------------------------------------------------------------------------|
| Active memory         |   76740 KB |  418152 KB |  645685 MB |  645610 MB |
|       from large pool |   69734 KB |  411711 KB |  637533 MB |  637464 MB |
|       from small pool |    7006 KB |    8907 KB |    8152 MB |    8145 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |     980 MB |     980 MB |     980 MB |       0 B  |
|       from large pool |     968 MB |     968 MB |     968 MB |       0 B  |
|       from small pool |      12 MB |      12 MB |      12 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  304187 KB |  621544 KB |  767952 MB |  767655 MB |
|       from large pool |  300953 KB |  618516 KB |  759522 MB |  759228 MB |
|       from small pool |    3234 KB |    6421 KB |    8429 MB |    8426 MB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102453    |  102395    |
|       from large pool |      11    |      21    |   31282    |   31271    |
|       from small pool |      47    |      58    |   71171    |   71124    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102453    |  102395    |
|       from large pool |      11    |      21    |   31282    |   31271    |
|       from small pool |      47    |      58    |   71171    |   71124    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |      11    |      11    |      11    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      22    |      37    |   33682    |   33660    |
|       from large pool |       5    |      16    |   16406    |   16401    |
|       from small pool |      17    |      26    |   17276    |   17259    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 15.308709 seconds
[EPOCH_TIME] 3.827177 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 3.458187 seconds
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006010, per step: 0.000048
presamping
presamping takes 12.104417085647583
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005328, per step: 0.000043
presamping
presamping takes 13.171827793121338
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005419, per step: 0.000043
presamping
presamping takes 12.882787704467773
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004774, per step: 0.000038
presamping
presamping takes 12.97390365600586

