succeed=True
[CUDA] cuda: usage: 5.73 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 137600 rows, 21370 columns and 320992 nonzeros
Model fingerprint: 0xd46e905b
Variable types: 9 continuous, 21361 integer (21361 binary)
Coefficient statistics:
  Matrix range     [5e-09, 2e+05]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 781614.08295
Presolve removed 116992 rows and 255 columns
Presolve time: 0.28s
Presolved: 20608 rows, 21115 columns, 61800 nonzeros
Variable types: 0 continuous, 21115 integer (21115 binary)
Found heuristic solution: objective 699270.80699

Root relaxation: objective 4.545091e+05, 24377 iterations, 0.81 seconds (0.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 454509.106    0 10361 699270.807 454509.106  35.0%     -    1s
H    0     0                    698639.82655 454509.106  34.9%     -    1s
H    0     0                    637017.81994 454509.106  28.7%     -    1s
H    0     0                    621648.63021 454509.106  26.9%     -    4s
H    0     0                    595235.37363 454509.106  23.6%     -    4s
H    0     0                    578480.19155 454509.106  21.4%     -    4s
H    0     0                    571565.34913 454509.106  20.5%     -    4s
H    0     0                    561151.52019 454509.106  19.0%     -    4s
H    0     0                    550472.10162 466301.339  15.3%     -    5s
H    0     0                    540207.52298 466301.339  13.7%     -    5s
H    0     0                    537796.01161 466301.339  13.3%     -    5s
H    0     0                    530767.87926 466301.339  12.1%     -    5s
H    0     0                    522329.24350 466301.339  10.7%     -    5s
H    0     0                    522321.34068 466301.339  10.7%     -    5s
H    0     0                    521141.80674 466301.339  10.5%     -    5s
H    0     0                    517315.01398 466301.339  9.86%     -    5s
     0     0 466301.339    0 7812 517315.014 466301.339  9.86%     -    5s
H    0     0                    504878.66939 466301.339  7.64%     -    7s
H    0     0                    504530.94859 470458.445  6.75%     -    8s
H    0     0                    503897.19153 470458.445  6.64%     -    8s
H    0     0                    501406.31114 470458.445  6.17%     -    8s
H    0     0                    497623.07060 470458.445  5.46%     -    8s
H    0     0                    497007.54673 470458.445  5.34%     -    8s
     0     0 470458.445    0 6044 497007.547 470458.445  5.34%     -    8s
     0     0 470552.043    0 6048 497007.547 470552.043  5.32%     -    8s
H    0     0                    497006.32934 470552.043  5.32%     -    9s
     0     0 476165.754    0 6784 497006.329 476165.754  4.19%     -   10s

Cutting planes:
  Gomory: 122
  Lift-and-project: 115
  Zero half: 155
  Mod-K: 2359

Explored 1 nodes (37395 simplex iterations) in 10.15 seconds (7.69 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 497006 497008 497623 ... 522321

Optimal solution found (tolerance 5.00e-02)
Best objective 4.970063293422e+05, best bound 4.761657536072e+05, gap 4.1932%
coll_cache:optimal_local_rate=0.107187,0.099615,0.0818551,0.102373,0.0963244,0.105385,0.0938153,0.0987743,
coll_cache:optimal_remote_rate=0.282148,0.28972,0.30748,0.286962,0.293011,0.283951,0.29552,0.290561,
coll_cache:optimal_cpu_rate=0.610665,0.610665,0.610665,0.610665,0.610665,0.610665,0.610665,0.610665,
z=497006
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.014488 | send           0.000000
        L1  recv             0.000000 | copy           0.296341 | convert time 0.000000 | train  0.031326
        L1  feature nbytes    2.03 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.296341
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.002628 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.293651 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.297691
        p90.00_tail_logl2featcopy=0.305301
        p95.00_tail_logl2featcopy=0.306479
        p99.00_tail_logl2featcopy=0.310886
        p99.90_tail_logl2featcopy=0.317250
[CUDA] cuda: usage: 13.86 GB
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.008106, per step: 0.000065
presamping
presamping takes 38.51839303970337
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007682, per step: 0.000061
presamping
presamping takes 37.241711378097534
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.021186, per step: 0.000169
presamping
presamping takes 38.63860893249512
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.011190, per step: 0.000090
presamping
presamping takes 38.35192370414734
config:eval_tsp="2023-04-14 22:40:17"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=ogbn-papers100M
config:epochs=4
config:batchsize=8000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.02
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=172
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7f992026b400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007061, per step: 0.000056
epoch=4 total_steps=500
presamping
presamping takes 37.325812339782715
start training...
[Epoch 0], time=44.19469618797302, loss=0.6931472420692444
[Epoch 1], time=42.81322360038757, loss=0.6931472420692444
[Epoch 2], time=42.78988170623779, loss=0.6931472420692444
[Epoch 3], time=42.73239278793335, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  269560 KB |    1501 MB |    2337 GB |    2337 GB |
|       from large pool |  256429 KB |    1490 MB |    2322 GB |    2322 GB |
|       from small pool |   13131 KB |      18 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Active memory         |  269560 KB |    1501 MB |    2337 GB |    2337 GB |
|       from large pool |  256429 KB |    1490 MB |    2322 GB |    2322 GB |
|       from small pool |   13131 KB |      18 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4958 MB |    4958 MB |    4958 MB |       0 B  |
|       from large pool |    4930 MB |    4930 MB |    4930 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   66312 KB |    1168 MB |    2007 GB |    2007 GB |
|       from large pool |   61011 KB |    1160 MB |    1992 GB |    1992 GB |
|       from small pool |    5301 KB |      15 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102463    |  102405    |
|       from large pool |      13    |      24    |   38797    |   38784    |
|       from small pool |      45    |      54    |   63666    |   63621    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102463    |  102405    |
|       from large pool |      13    |      24    |   38797    |   38784    |
|       from small pool |      45    |      54    |   63666    |   63621    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |      38    |      38    |       0    |
|       from large pool |      24    |      24    |      24    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      27    |      43    |   34424    |   34397    |
|       from large pool |       7    |      19    |   19735    |   19728    |
|       from small pool |      20    |      30    |   14689    |   14669    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 172.533907 seconds
[EPOCH_TIME] 43.133477 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 42.761474 seconds
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.021192, per step: 0.000170
presamping
presamping takes 38.774391412734985
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007581, per step: 0.000061
presamping
presamping takes 35.396931409835815
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.010394, per step: 0.000083
presamping
presamping takes 38.54384660720825

