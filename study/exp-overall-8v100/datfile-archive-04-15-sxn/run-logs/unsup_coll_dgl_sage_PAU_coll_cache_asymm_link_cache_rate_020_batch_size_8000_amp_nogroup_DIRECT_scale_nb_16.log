succeed=True
[CUDA] cuda: usage: 5.73 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 116216 rows, 18049 columns and 271096 nonzeros
Model fingerprint: 0x35585d67
Variable types: 9 continuous, 18040 integer (18040 binary)
Coefficient statistics:
  Matrix range     [5e-09, 1e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Presolve removed 98567 rows and 0 columns
Presolve time: 0.23s
Presolved: 17649 rows, 18049 columns, 70697 nonzeros
Variable types: 9 continuous, 18040 integer (18040 binary)
Found heuristic solution: objective 416732.64021
Found heuristic solution: objective 159330.05710
Warning: 1 variables dropped from basis
Warning: switch to quad precision

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24150    2.4045821e+04   3.215506e+03   0.000000e+00      5s
   32963    2.4426056e+04   6.264664e+06   0.000000e+00     10s
   35960    2.4433604e+04   0.000000e+00   0.000000e+00     14s

Root relaxation: objective 2.443360e+04, 35960 iterations, 13.25 seconds (8.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24433.6040    0 7425 159330.057 24433.6040  84.7%     -   13s
H    0     0                    132054.25749 24433.6040  81.5%     -   17s
H    0     0                    115773.41650 24433.6040  78.9%     -   17s
H    0     0                    107235.88284 24433.6040  77.2%     -   17s
H    0     0                    97362.901631 25355.3291  74.0%     -   21s
H    0     0                    90506.984317 25355.3291  72.0%     -   22s
     0     0 25444.8446    0 6060 90506.9843 25444.8446  71.9%     -   22s
H    0     0                    75474.019828 25444.8446  66.3%     -   23s
     0     0 26008.5143    0 6203 75474.0198 26008.5143  65.5%     -   27s
     0     0 26043.9356    0 6148 75474.0198 26043.9356  65.5%     -   29s
     0     0 26048.9408    0 6118 75474.0198 26048.9408  65.5%     -   32s
     0     0 26048.9408    0 6363 75474.0198 26048.9408  65.5%     -   33s
     0     0 26048.9408    0 6412 75474.0198 26048.9408  65.5%     -   34s
     0     0 26048.9408    0 6425 75474.0198 26048.9408  65.5%     -   35s
     0     0 26048.9408    0 6371 75474.0198 26048.9408  65.5%     -   36s
     0     0 26048.9408    0 6392 75474.0198 26048.9408  65.5%     -   36s
     0     0 26048.9408    0 6381 75474.0198 26048.9408  65.5%     -   37s
     0     0 26366.8079    0 6391 75474.0198 26366.8079  65.1%     -   37s
H    0     0                    57726.099836 26366.8079  54.3%     -   41s
H    0     0                    52459.972331 26369.9587  49.7%     -   57s
H    0     0                    40667.281387 26369.9587  35.2%     -   57s
H    0     0                    36918.066968 26369.9587  28.6%     -   57s
H    0     0                    34387.338779 26369.9587  23.3%     -   57s
     0     0 26369.9587    0 3456 34387.3388 26369.9587  23.3%     -   57s
H    0     0                    32438.590838 26369.9587  18.7%     -   57s
     0     0 26567.5520    0 1943 32438.5908 26567.5520  18.1%     -   65s
     0     0 26568.8575    0 1765 32438.5908 26568.8575  18.1%     -   67s
H    0     0                    31708.063376 26673.4807  15.9%     -   72s
     0     0 26673.4807    0  922 31708.0634 26673.4807  15.9%     -   72s
H    0     0                    28490.259568 26673.4807  6.38%     -   75s
     0     0 26673.4807    0  883 28490.2596 26673.4807  6.38%     -   76s
     0     0 26681.2842    0  668 28490.2596 26681.2842  6.35%     -   83s
H    0     0                    28422.144273 26681.2842  6.13%     -   85s
     0     0 26681.2842    0  605 28422.1443 26681.2842  6.13%     -   85s
     0     0 26681.2925    0  490 28422.1443 26681.2925  6.12%     -   91s
H    0     0                    27241.560827 26681.2925  2.06%     -  104s

Cutting planes:
  Gomory: 83
  Lift-and-project: 91
  Flow cover: 1
  Zero half: 3864

Explored 1 nodes (127184 simplex iterations) in 105.00 seconds (91.44 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 27241.6 28422.1 28490.3 ... 57726.1

Optimal solution found (tolerance 5.00e-02)
Best objective 2.724156082674e+04, best bound 2.668129253067e+04, gap 2.0567%
coll_cache:optimal_local_rate=0.374807,0.38131,0.38651,0.381009,0.38838,0.376092,0.38116,0.378277,
coll_cache:optimal_remote_rate=0.611014,0.604511,0.599312,0.604812,0.597442,0.609729,0.604661,0.607545,
coll_cache:optimal_cpu_rate=0.0141785,0.0141785,0.0141785,0.0141785,0.0141785,0.0141785,0.0141785,0.0141785,
z=27241.6
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=11429402112
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=11429402112
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=11429402112
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=11429402112
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=11429402112
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=11429402112
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=11429402112
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=11429402112
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.014615 | send           0.000000
        L1  recv             0.000000 | copy           0.030806 | convert time 0.000000 | train  0.024607
        L1  feature nbytes    2.03 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.030806
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.003520 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.027225 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.031070
        p90.00_tail_logl2featcopy=0.032725
        p95.00_tail_logl2featcopy=0.032936
        p99.00_tail_logl2featcopy=0.033151
        p99.90_tail_logl2featcopy=0.050954
[CUDA] cuda: usage: 24.15 GB
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.010337, per step: 0.000083
presamping
presamping takes 38.71802353858948
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007955, per step: 0.000064
presamping
presamping takes 37.90683031082153
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.011122, per step: 0.000089
presamping
presamping takes 38.172520875930786
config:eval_tsp="2023-04-15 00:23:58"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=ogbn-papers100M
config:epochs=4
config:batchsize=8000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.2
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=172
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7f195b50f400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007442, per step: 0.000060
epoch=4 total_steps=500
presamping
presamping takes 37.60835814476013
start training...
[Epoch 0], time=10.3050377368927, loss=0.6931472420692444
[Epoch 1], time=8.77048373222351, loss=0.6931472420692444
[Epoch 2], time=8.756014108657837, loss=0.6931472420692444
[Epoch 3], time=8.76231598854065, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  269186 KB |    1500 MB |    2337 GB |    2337 GB |
|       from large pool |  256070 KB |    1489 MB |    2323 GB |    2322 GB |
|       from small pool |   13116 KB |      18 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Active memory         |  269186 KB |    1500 MB |    2337 GB |    2337 GB |
|       from large pool |  256070 KB |    1489 MB |    2323 GB |    2322 GB |
|       from small pool |   13116 KB |      18 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3946 MB |    3946 MB |    3946 MB |       0 B  |
|       from large pool |    3918 MB |    3918 MB |    3918 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   42110 KB |    1157 MB |    2041 GB |    2041 GB |
|       from large pool |   38842 KB |    1149 MB |    2025 GB |    2025 GB |
|       from small pool |    3268 KB |      14 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102440    |  102382    |
|       from large pool |      13    |      24    |   38774    |   38761    |
|       from small pool |      45    |      54    |   63666    |   63621    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102440    |  102382    |
|       from large pool |      13    |      24    |   38774    |   38761    |
|       from small pool |      45    |      54    |   63666    |   63621    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      37    |      37    |      37    |       0    |
|       from large pool |      23    |      23    |      23    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      21    |      43    |   37437    |   37416    |
|       from large pool |       6    |      19    |   21257    |   21251    |
|       from small pool |      15    |      27    |   16180    |   16165    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 36.597056 seconds
[EPOCH_TIME] 9.149264 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 8.759444 seconds
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007520, per step: 0.000060
presamping
presamping takes 38.97317552566528
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.008545, per step: 0.000068
presamping
presamping takes 36.38654041290283
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.021151, per step: 0.000169
presamping
presamping takes 38.182825565338135
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.021193, per step: 0.000170
presamping
presamping takes 38.629990100860596

