succeed=True
[CUDA] cuda: usage: 5.32 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 127040 rows, 19730 columns and 296352 nonzeros
Model fingerprint: 0x08616ecc
Variable types: 9 continuous, 19721 integer (19721 binary)
Coefficient statistics:
  Matrix range     [8e-09, 9e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 2.000000e+09
Presolve removed 108032 rows and 255 columns
Presolve time: 0.26s
Presolved: 19008 rows, 19475 columns, 57000 nonzeros
Found heuristic solution: objective 662685.50491
Variable types: 0 continuous, 19475 integer (19475 binary)

Root relaxation: objective 3.317941e+05, 23587 iterations, 0.91 seconds (0.80 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 331794.125    0 10561 662685.505 331794.125  49.9%     -    1s
H    0     0                    659192.50801 331794.125  49.7%     -    1s
H    0     0                    556825.04448 331794.125  40.4%     -    1s
H    0     0                    523775.90750 331794.125  36.7%     -    4s
H    0     0                    492724.40063 331794.125  32.7%     -    4s
H    0     0                    477308.49911 331794.125  30.5%     -    4s
H    0     0                    466340.99023 331794.125  28.9%     -    4s
H    0     0                    437507.57044 331794.125  24.2%     -    4s
H    0     0                    435412.60084 354128.324  18.7%     -    6s
H    0     0                    433655.82378 354128.324  18.3%     -    6s
     0     0 354128.324    0 6027 433655.824 354128.324  18.3%     -    6s
H    0     0                    433071.90793 354128.324  18.2%     -    6s
H    0     0                    404319.80256 354128.324  12.4%     -    7s
     0     0 354579.089    0 6729 404319.803 354579.089  12.3%     -    8s
     0     0 355465.132    0 7010 404319.803 355465.132  12.1%     -    9s
     0     0 357394.514    0 7032 404319.803 357394.514  11.6%     -    9s
     0     0 358205.105    0 7376 404319.803 358205.105  11.4%     -   10s
     0     0 358541.725    0 7354 404319.803 358541.725  11.3%     -   10s
     0     0 358668.728    0 7367 404319.803 358668.728  11.3%     -   11s
     0     0 358848.947    0 7317 404319.803 358848.947  11.2%     -   12s
     0     0 358913.127    0 7314 404319.803 358913.127  11.2%     -   13s
H    0     0                    402730.55612 358933.594  10.9%     -   13s
     0     0 358933.594    0 7296 402730.556 358933.594  10.9%     -   13s
     0     0 358935.692    0 7273 402730.556 358935.692  10.9%     -   14s
H    0     0                    400699.59396 358935.692  10.4%     -   16s
H    0     0                    389202.33684 368133.284  5.41%     -   18s
H    0     0                    388822.52327 368133.284  5.32%     -   18s
     0     0 368133.284    0 1736 388822.523 368133.284  5.32%     -   18s
H    0     0                    387435.30338 368133.284  4.98%     -   18s

Cutting planes:
  Gomory: 70
  Lift-and-project: 44
  Zero half: 4138
  Mod-K: 1202

Explored 1 nodes (66787 simplex iterations) in 18.30 seconds (16.22 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 387435 388823 389202 ... 437508

Optimal solution found (tolerance 5.00e-02)
Best objective 3.874353033821e+05, best bound 3.681332835564e+05, gap 4.9820%
coll_cache:optimal_local_rate=0.123483,0.127554,0.124255,0.115993,0.124485,0.102545,0.130907,0.131445,
coll_cache:optimal_remote_rate=0.364014,0.359943,0.363242,0.371504,0.363012,0.384952,0.35659,0.356052,
coll_cache:optimal_cpu_rate=0.512503,0.512503,0.512503,0.512503,0.512503,0.512503,0.512503,0.512503,
z=387435
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=1410841600
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=1410841600
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=1410841600
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=1410841600
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=1410841600
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=1410841600
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=1410841600
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=1410841600
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.008289 | send           0.000000
        L1  recv             0.000000 | copy           0.234938 | convert time 0.000000 | train  0.026552
        L1  feature nbytes    2.21 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.234938
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.001557 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.233310 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.235802
        p90.00_tail_logl2featcopy=0.244062
        p95.00_tail_logl2featcopy=0.245477
        p99.00_tail_logl2featcopy=0.247248
        p99.90_tail_logl2featcopy=0.259849
[CUDA] cuda: usage: 11.84 GB
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005978, per step: 0.000048
presamping
presamping takes 19.37932324409485
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006690, per step: 0.000054
presamping
presamping takes 19.67973828315735
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007548, per step: 0.000060
presamping
presamping takes 19.664257764816284
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.012149, per step: 0.000097
presamping
presamping takes 19.71887731552124
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007341, per step: 0.000059
presamping
presamping takes 20.154072761535645
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.009001, per step: 0.000072
presamping
presamping takes 18.86406683921814
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.012137, per step: 0.000097
presamping
presamping takes 20.081318140029907
config:eval_tsp="2023-04-15 03:26:01"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=com-friendster
config:epochs=4
config:batchsize=4000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.02
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=100
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7f549bea2400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005709, per step: 0.000046
epoch=4 total_steps=500
presamping
presamping takes 18.957152366638184
start training...
[Epoch 0], time=35.20687174797058, loss=0.6931472420692444
[Epoch 1], time=33.7232563495636, loss=0.6931472420692444
[Epoch 2], time=33.73739576339722, loss=0.6931472420692444
[Epoch 3], time=33.73332643508911, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  150451 KB |    1427 MB |    1551 GB |    1551 GB |
|       from large pool |  140061 KB |    1417 MB |    1537 GB |    1537 GB |
|       from small pool |   10390 KB |      14 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Active memory         |  150451 KB |    1427 MB |    1551 GB |    1551 GB |
|       from large pool |  140061 KB |    1417 MB |    1537 GB |    1537 GB |
|       from small pool |   10390 KB |      14 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2658 MB |    2658 MB |    2658 MB |       0 B  |
|       from large pool |    2638 MB |    2638 MB |    2638 MB |       0 B  |
|       from small pool |      20 MB |      20 MB |      20 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   50252 KB |    1198 MB |    1318 GB |    1318 GB |
|       from large pool |   46306 KB |    1192 MB |    1303 GB |    1303 GB |
|       from small pool |    3946 KB |       9 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102434    |  102376    |
|       from large pool |      12    |      22    |   32269    |   32257    |
|       from small pool |      46    |      57    |   70165    |   70119    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102434    |  102376    |
|       from large pool |      12    |      22    |   32269    |   32257    |
|       from small pool |      46    |      57    |   70165    |   70119    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      26    |      26    |       0    |
|       from large pool |      16    |      16    |      16    |       0    |
|       from small pool |      10    |      10    |      10    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |      43    |   37261    |   37236    |
|       from large pool |       8    |      19    |   18134    |   18126    |
|       from small pool |      17    |      29    |   19127    |   19110    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 136.402449 seconds
[EPOCH_TIME] 34.100612 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 33.735573 seconds

