succeed=True
[CUDA] cuda: usage: 5.23 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 161360 rows, 25060 columns and 376432 nonzeros
Model fingerprint: 0xf3d3b021
Variable types: 9 continuous, 25051 integer (25051 binary)
Coefficient statistics:
  Matrix range     [8e-09, 5e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 8e+03]
Found heuristic solution: objective 381488.38557
Presolve removed 136871 rows and 0 columns
Presolve time: 0.39s
Presolved: 24489 rows, 25060 columns, 98316 nonzeros
Variable types: 9 continuous, 25051 integer (25051 binary)

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35162    2.4392213e+04   4.056725e+04   0.000000e+00      5s
   38771    2.8123734e+04   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 2.812373e+04, 38771 iterations, 6.01 seconds (5.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28123.7335    0 11561 381488.386 28123.7335  92.6%     -    6s
H    0     0                    381482.46783 28123.7335  92.6%     -    6s
H    0     0                    243741.89129 28123.7335  88.5%     -   12s
H    0     0                    229457.60492 34370.9119  85.0%     -   13s
     0     0 35333.3409    0 8314 229457.605 35333.3409  84.6%     -   13s
H    0     0                    156727.64124 35333.3409  77.5%     -   14s
     0     0 37708.9655    0 7576 156727.641 37708.9655  75.9%     -   15s
H    0     0                    145018.26197 37708.9655  74.0%     -   16s
     0     0 38765.0132    0 7469 145018.262 38765.0132  73.3%     -   16s
     0     0 39091.3952    0 7773 145018.262 39091.3952  73.0%     -   17s
     0     0 39663.9962    0 8282 145018.262 39663.9962  72.6%     -   17s
H    0     0                    126562.34880 39895.3114  68.5%     -   19s
H    0     0                    115112.18566 39895.3114  65.3%     -   19s
     0     0 40049.4688    0 8638 115112.186 40049.4688  65.2%     -   19s
     0     0 40090.5211    0 8803 115112.186 40090.5211  65.2%     -   19s
H    0     0                    103784.30120 40090.5211  61.4%     -   20s
     0     0 40090.5211    0 8860 103784.301 40090.5211  61.4%     -   20s
H    0     0                    95363.827560 40125.6909  57.9%     -   21s
     0     0 40169.9919    0 8890 95363.8276 40169.9919  57.9%     -   21s
     0     0 40181.0050    0 8907 95363.8276 40181.0050  57.9%     -   21s
H    0     0                    91955.215185 40181.0050  56.3%     -   22s
     0     0 40181.6041    0 8879 91955.2152 40181.6041  56.3%     -   22s
H    0     0                    89878.550999 40181.6041  55.3%     -   23s
     0     0 40181.6041    0 8875 89878.5510 40181.6041  55.3%     -   24s
     0     0 40181.6041    0 8868 89878.5510 40181.6041  55.3%     -   26s
     0     0 40181.6041    0 8846 89878.5510 40181.6041  55.3%     -   27s
H    0     0                    77914.245390 40181.6041  48.4%     -   32s
H    0     0                    76958.707974 40181.6041  47.8%     -   32s
H    0     0                    73341.507826 43836.7120  40.2%     -   34s
H    0     0                    70994.288705 43836.7120  38.3%     -   34s
H    0     0                    44797.452987 43836.7120  2.14%     -   34s
     0     0 43836.7120    0 1284 44797.4530 43836.7120  2.14%     -   34s

Cutting planes:
  Gomory: 66
  Lift-and-project: 134
  Zero half: 7449

Explored 1 nodes (87127 simplex iterations) in 34.11 seconds (27.47 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 44797.5 70994.3 73341.5 ... 115112

Optimal solution found (tolerance 5.00e-02)
Best objective 4.479745298655e+04, best bound 4.383671197410e+04, gap 2.1446%
coll_cache:optimal_local_rate=0.243294,0.207831,0.202687,0.260167,0.250612,0.193173,0.211838,0.249507,
coll_cache:optimal_remote_rate=0.661836,0.697299,0.702443,0.644963,0.654518,0.711957,0.693293,0.655623,
coll_cache:optimal_cpu_rate=0.0948699,0.0948699,0.0948699,0.0948699,0.0948699,0.0948699,0.0948699,0.0948699,
z=44797.5
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.004550 | send           0.000000
        L1  recv             0.000000 | copy           0.034142 | convert time 0.000000 | train  0.010583
        L1  feature nbytes    1.19 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.034142
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.001081 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.033007 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.034337
        p90.00_tail_logl2featcopy=0.035256
        p95.00_tail_logl2featcopy=0.035467
        p99.00_tail_logl2featcopy=0.035820
        p99.90_tail_logl2featcopy=0.048752
[CUDA] cuda: usage: 14.22 GB
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007584, per step: 0.000061
presamping
presamping takes 11.751293659210205
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007617, per step: 0.000061
presamping
presamping takes 11.61858606338501
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005090, per step: 0.000041
presamping
presamping takes 11.600864171981812
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005378, per step: 0.000043
presamping
presamping takes 11.820119380950928
config:eval_tsp="2023-04-15 01:36:41"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=com-friendster
config:epochs=4
config:batchsize=2000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.08
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=100
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7f6627e61400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004701, per step: 0.000038
epoch=4 total_steps=500
presamping
presamping takes 11.761100769042969
start training...
[Epoch 0], time=7.648975372314453, loss=0.6931472420692444
[Epoch 1], time=6.1664440631866455, loss=0.6931472420692444
[Epoch 2], time=6.165808439254761, loss=0.6931472420692444
[Epoch 3], time=6.17113995552063, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   80705 KB |  780362 KB |     818 GB |     818 GB |
|       from large pool |   73437 KB |  773902 KB |     810 GB |     810 GB |
|       from small pool |    7268 KB |    9039 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |   80705 KB |  780362 KB |     818 GB |     818 GB |
|       from large pool |   73437 KB |  773902 KB |     810 GB |     810 GB |
|       from small pool |    7268 KB |    9039 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1994 MB |    1994 MB |    1994 MB |       0 B  |
|       from large pool |    1982 MB |    1982 MB |    1982 MB |       0 B  |
|       from small pool |      12 MB |      12 MB |      12 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  648382 KB |    1282 MB |     889 GB |     889 GB |
|       from large pool |  645411 KB |    1278 MB |     881 GB |     880 GB |
|       from small pool |    2971 KB |       6 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102439    |  102381    |
|       from large pool |      12    |      22    |   31273    |   31261    |
|       from small pool |      46    |      57    |   71166    |   71120    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102439    |  102381    |
|       from large pool |      12    |      22    |   31273    |   31261    |
|       from small pool |      46    |      57    |   71166    |   71120    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|       from large pool |      12    |      12    |      12    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |      35    |   36425    |   36402    |
|       from large pool |       8    |      16    |   16988    |   16980    |
|       from small pool |      15    |      26    |   19437    |   19422    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 26.153869 seconds
[EPOCH_TIME] 6.538467 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 6.168666 seconds
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004792, per step: 0.000038
presamping
presamping takes 11.295745849609375
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006270, per step: 0.000050
presamping
presamping takes 11.53870940208435
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005546, per step: 0.000044
presamping
presamping takes 11.803008317947388

