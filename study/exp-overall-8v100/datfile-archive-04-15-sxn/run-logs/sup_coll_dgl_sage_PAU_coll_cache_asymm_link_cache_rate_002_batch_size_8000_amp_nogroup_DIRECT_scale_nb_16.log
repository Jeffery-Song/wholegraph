succeed=True
[CUDA] cuda: usage: 5.18 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 140240 rows, 21780 columns and 327152 nonzeros
Model fingerprint: 0xdd7aaa10
Variable types: 9 continuous, 21771 integer (21771 binary)
Coefficient statistics:
  Matrix range     [5e-09, 7e+02]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 6e+02]
Found heuristic solution: objective 27714.145272
Presolve removed 119311 rows and 369 columns
Presolve time: 0.29s
Presolved: 20929 rows, 21411 columns, 83995 nonzeros
Variable types: 9 continuous, 21402 integer (21402 binary)

Root relaxation: objective 2.030944e+03, 34243 iterations, 3.62 seconds (3.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2030.94422    0 11001 27714.1453 2030.94422  92.7%     -    4s
H    0     0                    17536.829481 2030.94422  88.4%     -    8s
H    0     0                    13182.422572 2431.45553  81.6%     -   10s
H    0     0                    4834.8408494 2431.45553  49.7%     -   10s
     0     0 2644.12005    0 6010 4834.84085 2644.12005  45.3%     -   10s
H    0     0                    4404.3292038 2644.12005  40.0%     -   11s
     0     0 2668.38405    0 3605 4404.32920 2668.38405  39.4%     -   12s
     0     0 2673.24365    0 3264 4404.32920 2673.24365  39.3%     -   12s
     0     0 2673.24365    0 3362 4404.32920 2673.24365  39.3%     -   14s
     0     0 2738.65810    0 3345 4404.32920 2738.65810  37.8%     -   14s
H    0     0                    4064.0522181 2738.65810  32.6%     -   14s
     0     0 2738.65810    0 3347 4064.05222 2738.65810  32.6%     -   14s
     0     0 2738.65810    0 3350 4064.05222 2738.65810  32.6%     -   15s
     0     0 2738.65810    0 3323 4064.05222 2738.65810  32.6%     -   15s
     0     0 2738.65810    0 3305 4064.05222 2738.65810  32.6%     -   15s
     0     0 2738.65810    0 3307 4064.05222 2738.65810  32.6%     -   15s
     0     0 2738.65810    0 3287 4064.05222 2738.65810  32.6%     -   15s
H    0     0                    2837.7821615 2738.65810  3.49%     -   17s

Cutting planes:
  Gomory: 200
  Lift-and-project: 176
  Zero half: 3875

Explored 1 nodes (51805 simplex iterations) in 17.38 seconds (13.47 work units)
Thread count was 48 (of 96 available processors)

Solution count 7: 2837.78 4064.05 4404.33 ... 27714.1

Optimal solution found (tolerance 5.00e-02)
Best objective 2.837782161534e+03, best bound 2.738664479472e+03, gap 3.4928%
coll_cache:optimal_local_rate=0.296048,0.205803,0.218115,0.199345,0.248081,0.214494,0.250207,0.20653,
coll_cache:optimal_remote_rate=0.623264,0.713509,0.701197,0.719967,0.671231,0.704818,0.669105,0.712782,
coll_cache:optimal_cpu_rate=0.0806878,0.0806878,0.0806878,0.0806878,0.0806878,0.0806878,0.0806878,0.0806878,
z=2837.78
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=1194116608
    [Step(average) Profiler Level 1 E3 S143]
        L1  sample           0.004623 | send           0.000000
        L1  recv             0.000000 | copy           0.015736 | convert time 0.000000 | train  0.010767
        L1  feature nbytes  515.63 MB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S143]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.015736
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S143]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.000918 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.014774 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S143]
        p50.00_tail_logl2featcopy=0.015671
        p90.00_tail_logl2featcopy=0.017949
        p95.00_tail_logl2featcopy=0.018202
        p99.00_tail_logl2featcopy=0.021855
        p99.90_tail_logl2featcopy=0.024971
[CUDA] cuda: usage: 7.95 GB
config:eval_tsp="2023-04-15 05:56:35"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=ogbn-papers100M
config:epochs=4
config:batchsize=8000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.02
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=False
config:classnum=172
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7fba75d963d0>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!Train_dataloader(with 18 items) enumerate latency: 0.7960572242736816
!!!!Train_data_list(with 18 items) enumerate latency: 6.4373016357421875e-06, transfer latency: 0.7601983547210693
epoch=4 total_steps=72
presamping
presamping takes 1.254791259765625
start training...
[Epoch 0], time=1.9895479679107666, loss=5.0989484786987305
[Epoch 1], time=0.5624642372131348, loss=5.050017356872559
[Epoch 2], time=0.5613551139831543, loss=5.00382661819458
[Epoch 3], time=0.5614655017852783, loss=4.960328578948975
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69439 KB |  369901 KB |   95899 MB |   95831 MB |
|       from large pool |   63085 KB |  363797 KB |   94750 MB |   94689 MB |
|       from small pool |    6353 KB |    8754 KB |    1148 MB |    1142 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69439 KB |  369901 KB |   95899 MB |   95831 MB |
|       from large pool |   63085 KB |  363797 KB |   94750 MB |   94689 MB |
|       from small pool |    6353 KB |    8754 KB |    1148 MB |    1142 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  755712 KB |  755712 KB |  755712 KB |       0 B  |
|       from large pool |  743424 KB |  743424 KB |  743424 KB |       0 B  |
|       from small pool |   12288 KB |   12288 KB |   12288 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   20673 KB |  440524 KB |   99464 MB |   99444 MB |
|       from large pool |   18834 KB |  436354 KB |   98277 MB |   98258 MB |
|       from small pool |    1838 KB |    7054 KB |    1187 MB |    1185 MB |
|---------------------------------------------------------------------------|
| Allocations           |      55    |      69    |   11475    |   11420    |
|       from large pool |      11    |      22    |    4160    |    4149    |
|       from small pool |      44    |      49    |    7315    |    7271    |
|---------------------------------------------------------------------------|
| Active allocs         |      55    |      69    |   11475    |   11420    |
|       from large pool |      11    |      22    |    4160    |    4149    |
|       from small pool |      44    |      49    |    7315    |    7271    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |      19    |      19    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      33    |    4920    |    4902    |
|       from large pool |       6    |      15    |    2869    |    2863    |
|       from small pool |      12    |      22    |    2051    |    2039    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 3.678214 seconds
[EPOCH_TIME] 0.919554 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 0.561675 seconds
Rank=6, Graph loaded.
!!!!Train_dataloader(with 18 items) enumerate latency: 0.8739831447601318
!!!!Train_data_list(with 18 items) enumerate latency: 7.152557373046875e-06, transfer latency: 0.8359785079956055
presamping
presamping takes 1.8049368858337402
Rank=2, Graph loaded.
!!!!Train_dataloader(with 18 items) enumerate latency: 0.8174898624420166
!!!!Train_data_list(with 18 items) enumerate latency: 7.62939453125e-06, transfer latency: 0.7846846580505371
presamping
presamping takes 1.5543484687805176
Rank=1, Graph loaded.
!!!!Train_dataloader(with 18 items) enumerate latency: 0.8726098537445068
!!!!Train_data_list(with 18 items) enumerate latency: 8.58306884765625e-06, transfer latency: 0.8350739479064941
presamping
presamping takes 1.5728435516357422
Rank=5, Graph loaded.
!!!!Train_dataloader(with 18 items) enumerate latency: 0.8949825763702393
!!!!Train_data_list(with 18 items) enumerate latency: 9.775161743164062e-06, transfer latency: 0.8357987403869629
presamping
presamping takes 1.6429455280303955
Rank=7, Graph loaded.
!!!!Train_dataloader(with 18 items) enumerate latency: 0.8117964267730713
!!!!Train_data_list(with 18 items) enumerate latency: 6.67572021484375e-06, transfer latency: 0.7829368114471436
presamping
presamping takes 1.5611038208007812
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!Train_dataloader(with 18 items) enumerate latency: 0.8068621158599854
!!!!Train_data_list(with 18 items) enumerate latency: 5.7220458984375e-06, transfer latency: 0.7379350662231445
presamping
presamping takes 1.6602168083190918
Rank=3, Graph loaded.
!!!!Train_dataloader(with 18 items) enumerate latency: 0.8243515491485596
!!!!Train_data_list(with 18 items) enumerate latency: 7.62939453125e-06, transfer latency: 0.7828974723815918
presamping
presamping takes 1.538440465927124

