succeed=True
[CUDA] cuda: usage: 5.43 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 144992 rows, 22518 columns and 338240 nonzeros
Model fingerprint: 0x3150400d
Variable types: 9 continuous, 22509 integer (22509 binary)
Coefficient statistics:
  Matrix range     [5e-09, 6e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 8e+03]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Presolve removed 122983 rows and 0 columns
Presolve time: 0.32s
Presolved: 22009 rows, 22518 columns, 88246 nonzeros
Variable types: 9 continuous, 22509 integer (22509 binary)
Found heuristic solution: objective 260085.44511
Found heuristic solution: objective 122752.02968
Warning: Markowitz tolerance tightened to 0.0625

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30635    1.8091360e+04   7.054289e+04   0.000000e+00      5s
   38196    2.2542082e+04   0.000000e+00   0.000000e+00      8s

Root relaxation: objective 2.254208e+04, 38196 iterations, 7.14 seconds (7.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22542.0816    0 10953 122752.030 22542.0816  81.6%     -    7s
H    0     0                    113217.44554 22542.0816  80.1%     -   13s
H    0     0                    101865.37117 27614.8197  72.9%     -   18s
H    0     0                    94200.607553 27614.8197  70.7%     -   18s
H    0     0                    87471.272981 27614.8197  68.4%     -   18s
     0     0 27614.8197    0 8730 87471.2730 27614.8197  68.4%     -   18s
H    0     0                    64192.800882 27614.8197  57.0%     -   19s
     0     0 29519.2055    0 7938 64192.8009 29519.2055  54.0%     -   20s
     0     0 30549.7047    0 7388 64192.8009 30549.7047  52.4%     -   21s
     0     0 31897.9466    0 7036 64192.8009 31897.9466  50.3%     -   22s
     0     0 32656.3813    0 7307 64192.8009 32656.3813  49.1%     -   23s
     0     0 32699.2467    0 7324 64192.8009 32699.2467  49.1%     -   23s
     0     0 32717.6967    0 7317 64192.8009 32717.6967  49.0%     -   24s
     0     0 32743.2541    0 7307 64192.8009 32743.2541  49.0%     -   24s
     0     0 32763.9636    0 7327 64192.8009 32763.9636  49.0%     -   24s
     0     0 32785.9185    0 7320 64192.8009 32785.9185  48.9%     -   25s
     0     0 32797.4870    0 7273 64192.8009 32797.4870  48.9%     -   25s
     0     0 32804.1558    0 7286 64192.8009 32804.1558  48.9%     -   25s
     0     0 32804.9378    0 7274 64192.8009 32804.9378  48.9%     -   25s
H    0     0                    61852.600721 38041.7808  38.5%     -   30s
     0     0 38041.7808    0  661 61852.6007 38041.7808  38.5%     -   30s
H    0     0                    46411.725774 38041.7808  18.0%     -   30s
H    0     0                    44052.212226 38041.7808  13.6%     -   30s
H    0     0                    39067.447628 38109.3604  2.45%     -   34s
     0     0 38109.3604    0  377 39067.4476 38109.3604  2.45%     -   34s

Cutting planes:
  Gomory: 84
  Lift-and-project: 35
  MIR: 6
  StrongCG: 4
  Flow cover: 2
  Zero half: 5639

Explored 1 nodes (81568 simplex iterations) in 34.90 seconds (31.02 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 39067.4 44052.2 46411.7 ... 122752

Optimal solution found (tolerance 5.00e-02)
Best objective 3.906744762797e+04, best bound 3.810936041324e+04, gap 2.4524%
coll_cache:optimal_local_rate=0.193714,0.220703,0.253252,0.265655,0.226347,0.194167,0.265797,0.241887,
coll_cache:optimal_remote_rate=0.732092,0.705103,0.672554,0.660151,0.699459,0.731639,0.660009,0.683919,
coll_cache:optimal_cpu_rate=0.0741941,0.0741941,0.0741941,0.0741941,0.0741941,0.0741941,0.0741941,0.0741941,
z=39067.4
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=6880386048
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.007717 | send           0.000000
        L1  recv             0.000000 | copy           0.031545 | convert time 0.000000 | train  0.013517
        L1  feature nbytes    1.07 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.031545
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.001912 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.029577 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.031493
        p90.00_tail_logl2featcopy=0.032684
        p95.00_tail_logl2featcopy=0.033021
        p99.00_tail_logl2featcopy=0.033429
        p99.90_tail_logl2featcopy=0.044972
[CUDA] cuda: usage: 16.46 GB
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005954, per step: 0.000048
presamping
presamping takes 22.336861610412598
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005861, per step: 0.000047
presamping
presamping takes 21.868823528289795
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.012138, per step: 0.000097
presamping
presamping takes 22.352745056152344
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005757, per step: 0.000046
presamping
presamping takes 21.720771074295044
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006945, per step: 0.000056
presamping
presamping takes 23.511964797973633
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.012074, per step: 0.000097
presamping
presamping takes 22.857269763946533
config:eval_tsp="2023-04-14 21:14:41"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=ogbn-papers100M
config:epochs=4
config:batchsize=4000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.12
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=172
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7fb723931400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005498, per step: 0.000044
epoch=4 total_steps=500
presamping
presamping takes 21.469608545303345
start training...
[Epoch 0], time=8.087970495223999, loss=0.6931472420692444
[Epoch 1], time=6.607791423797607, loss=0.6931472420692444
[Epoch 2], time=6.605844020843506, loss=0.6931472420692444
[Epoch 3], time=6.60505485534668, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  140258 KB |     786 MB |    1208 GB |    1208 GB |
|       from large pool |  130133 KB |     776 MB |    1195 GB |    1194 GB |
|       from small pool |   10124 KB |      14 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Active memory         |  140258 KB |     786 MB |    1208 GB |    1208 GB |
|       from large pool |  130133 KB |     776 MB |    1195 GB |    1194 GB |
|       from small pool |   10124 KB |      14 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2482 MB |    2482 MB |    2482 MB |       0 B  |
|       from large pool |    2462 MB |    2462 MB |    2462 MB |       0 B  |
|       from small pool |      20 MB |      20 MB |      20 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   52254 KB |     869 MB |    1090 GB |    1089 GB |
|       from large pool |   45994 KB |     863 MB |    1076 GB |    1076 GB |
|       from small pool |    6259 KB |       9 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102448    |  102390    |
|       from large pool |      11    |      21    |   32278    |   32267    |
|       from small pool |      47    |      58    |   70170    |   70123    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102448    |  102390    |
|       from large pool |      11    |      21    |   32278    |   32267    |
|       from small pool |      47    |      58    |   70170    |   70123    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      28    |      28    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |      10    |      10    |      10    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |      42    |   33008    |   32979    |
|       from large pool |      10    |      18    |   15748    |   15738    |
|       from small pool |      19    |      29    |   17260    |   17241    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 27.909867 seconds
[EPOCH_TIME] 6.977467 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 6.605693 seconds
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007206, per step: 0.000058
presamping
presamping takes 22.86510181427002

