succeed=True
[CUDA] cuda: usage: 5.53 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 149216 rows, 23174 columns and 348096 nonzeros
Model fingerprint: 0x3c297385
Variable types: 9 continuous, 23165 integer (23165 binary)
Coefficient statistics:
  Matrix range     [2e-09, 4e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 78248.542959
Presolve removed 127007 rows and 451 columns
Presolve time: 0.35s
Presolved: 22209 rows, 22723 columns, 89099 nonzeros
Variable types: 9 continuous, 22714 integer (22714 binary)

Root relaxation: objective 2.533304e+04, 26431 iterations, 0.88 seconds (0.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 25333.0437    0 11401 78248.5430 25333.0437  67.6%     -    1s
H    0     0                    76153.529994 25333.0437  66.7%     -    1s
H    0     0                    70167.679733 25333.0437  63.9%     -    1s
H    0     0                    60729.123065 25333.0437  58.3%     -    3s
H    0     0                    53265.757778 25333.0437  52.4%     -    3s
H    0     0                    50891.705358 25333.0437  50.2%     -    3s
H    0     0                    48524.967286 25333.0437  47.8%     -    3s
H    0     0                    47745.223029 26630.3971  44.2%     -    6s
H    0     0                    44476.932901 26630.3971  40.1%     -    8s
H    0     0                    41982.331491 26630.3971  36.6%     -    8s
     0     0 26694.8272    0 9135 41982.3315 26694.8272  36.4%     -    8s
H    0     0                    38234.122282 26694.8272  30.2%     -   10s
H    0     0                    37175.250365 27288.3904  26.6%     -   11s
H    0     0                    36195.402757 27288.3904  24.6%     -   11s
H    0     0                    35699.932912 27288.3904  23.6%     -   11s
     0     0 27288.3904    0 7530 35699.9329 27288.3904  23.6%     -   11s
     0     0 27288.6882    0 7527 35699.9329 27288.6882  23.6%     -   11s
     0     0 28150.2470    0 8594 35699.9329 28150.2470  21.1%     -   17s
H    0     0                    35443.120329 28150.2470  20.6%     -   18s
H    0     0                    34568.973143 28218.0486  18.4%     -   18s
     0     0 28218.0486    0 8459 34568.9731 28218.0486  18.4%     -   18s
H    0     0                    34247.587365 28512.5779  16.7%     -   19s
     0     0 28512.5779    0 7716 34247.5874 28512.5779  16.7%     -   19s
     0     0 28525.8171    0 7578 34247.5874 28525.8171  16.7%     -   19s
H    0     0                    33725.727851 28525.8171  15.4%     -   19s
     0     0 28525.8171    0 7558 33725.7279 28525.8171  15.4%     -   19s
H    0     0                    33303.431932 28525.8171  14.3%     -   24s
H    0     0                    33303.431764 28811.2696  13.5%     -   25s
     0     0 28811.2696    0 6390 33303.4318 28811.2696  13.5%     -   25s
H    0     0                    31807.317039 28811.2696  9.42%     -   26s
     0     0 29280.4680    0 4942 31807.3170 29280.4680  7.94%     -   28s
     0     0 29313.8727    0 4992 31807.3170 29313.8727  7.84%     -   28s
     0     0 29316.9208    0 5039 31807.3170 29316.9208  7.83%     -   28s
     0     0 29532.9642    0 3292 31807.3170 29532.9642  7.15%     -   33s
     0     0 29681.4750    0 2160 31807.3170 29681.4750  6.68%     -   33s
     0     0 29684.3252    0 2171 31807.3170 29684.3252  6.67%     -   34s
     0     0 29721.0019    0 1304 31807.3170 29721.0019  6.56%     -   35s
H    0     0                    31043.686652 29721.0019  4.26%     -   36s

Cutting planes:
  Gomory: 226
  Lift-and-project: 34
  MIR: 72
  Flow cover: 88
  Zero half: 4247
  Mod-K: 1509

Explored 1 nodes (66621 simplex iterations) in 36.29 seconds (24.09 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 31043.7 31807.3 33303.4 ... 36195.4

Optimal solution found (tolerance 5.00e-02)
Best objective 3.104368665156e+04, best bound 2.972100190229e+04, gap 4.2607%
coll_cache:optimal_local_rate=0.185749,0.1521,0.167469,0.159058,0.160509,0.168626,0.183633,0.148034,
coll_cache:optimal_remote_rate=0.447182,0.480831,0.465462,0.473873,0.472422,0.464305,0.449298,0.484897,
coll_cache:optimal_cpu_rate=0.367069,0.367069,0.367069,0.367069,0.367069,0.367069,0.367069,0.367069,
z=31043.7
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=7875640320
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.003755 | send           0.000000
        L1  recv             0.000000 | copy           0.117730 | convert time 0.000000 | train  0.030079
        L1  feature nbytes    1.36 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.117730
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.000754 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.116908 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.123908
        p90.00_tail_logl2featcopy=0.125864
        p95.00_tail_logl2featcopy=0.126318
        p99.00_tail_logl2featcopy=0.127222
        p99.90_tail_logl2featcopy=0.138296
[CUDA] cuda: usage: 18.81 GB
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006105, per step: 0.000049
presamping
presamping takes 8.301053762435913
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005452, per step: 0.000044
presamping
presamping takes 10.772450685501099
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004790, per step: 0.000038
presamping
presamping takes 11.87475037574768
config:eval_tsp="2023-04-15 05:39:24"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=mag240m-homo
config:epochs=4
config:batchsize=2000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.02
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=153
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7f81d3fce400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004690, per step: 0.000038
epoch=4 total_steps=500
presamping
presamping takes 12.01574420928955
start training...
[Epoch 0], time=20.47412943840027, loss=0.6931472420692444
[Epoch 1], time=18.961843490600586, loss=0.6931472420692444
[Epoch 2], time=18.951561212539673, loss=0.6931472420692444
[Epoch 3], time=18.9505295753479, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   88510 KB |  723768 KB |     968 GB |     968 GB |
|       from large pool |   76713 KB |  712562 KB |     958 GB |     958 GB |
|       from small pool |   11796 KB |   14135 KB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Active memory         |   88510 KB |  723768 KB |     968 GB |     968 GB |
|       from large pool |   76713 KB |  712562 KB |     958 GB |     958 GB |
|       from small pool |   11796 KB |   14135 KB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3732 MB |    3732 MB |    3732 MB |       0 B  |
|       from large pool |    3714 MB |    3714 MB |    3714 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   48706 KB |    1037 MB |     792 GB |     792 GB |
|       from large pool |   46166 KB |    1034 MB |     781 GB |     781 GB |
|       from small pool |    2539 KB |       5 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Allocations           |      62    |      81    |  106957    |  106895    |
|       from large pool |      15    |      26    |   35785    |   35770    |
|       from small pool |      47    |      58    |   71172    |   71125    |
|---------------------------------------------------------------------------|
| Active allocs         |      62    |      81    |  106957    |  106895    |
|       from large pool |      15    |      26    |   35785    |   35770    |
|       from small pool |      47    |      58    |   71172    |   71125    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      26    |      26    |      26    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |      37    |   39738    |   39715    |
|       from large pool |       7    |      17    |   19734    |   19727    |
|       from small pool |      16    |      25    |   20004    |   19988    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 77.341550 seconds
[EPOCH_TIME] 19.335388 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 18.951347 seconds
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005454, per step: 0.000044
presamping
presamping takes 11.402496576309204
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007614, per step: 0.000061
presamping
presamping takes 12.185101985931396
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007037, per step: 0.000056
presamping
presamping takes 12.308890581130981
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006138, per step: 0.000049
presamping
presamping takes 11.414502143859863

