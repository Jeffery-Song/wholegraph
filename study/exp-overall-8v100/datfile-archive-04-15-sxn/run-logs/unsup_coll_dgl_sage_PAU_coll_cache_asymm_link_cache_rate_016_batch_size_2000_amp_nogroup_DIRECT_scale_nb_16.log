succeed=True
[CUDA] cuda: usage: 5.29 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 126776 rows, 19689 columns and 295736 nonzeros
Model fingerprint: 0x29d7ba04
Variable types: 9 continuous, 19680 integer (19680 binary)
Coefficient statistics:
  Matrix range     [5e-09, 3e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+03]
Presolve removed 107527 rows and 0 columns
Presolve time: 0.28s
Presolved: 19249 rows, 19689 columns, 77137 nonzeros
Variable types: 9 continuous, 19680 integer (19680 binary)
Found heuristic solution: objective 111426.43012
Found heuristic solution: objective 42321.234812
Warning: Markowitz tolerance tightened to 0.0625

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28017    7.4009464e+03   1.540265e+04   0.000000e+00      5s
   37937    7.4768874e+03   1.197844e-01   0.000000e+00     10s
   38262    7.4768850e+03   0.000000e+00   0.000000e+00     10s

Root relaxation: objective 7.476885e+03, 38262 iterations, 9.88 seconds (11.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7476.88499    0 9281 42321.2348 7476.88499  82.3%     -   10s
H    0     0                    40101.559763 7476.88499  81.4%     -   16s
H    0     0                    38386.364899 7476.88499  80.5%     -   16s
H    0     0                    36921.213287 7476.88499  79.7%     -   16s
H    0     0                    32258.877645 7476.88499  76.8%     -   16s
     0     0 7811.73090    0 6647 32258.8776 7811.73090  75.8%     -   20s
H    0     0                    26286.065181 7811.73090  70.3%     -   23s
     0     0 7870.75213    0 6663 26286.0652 7870.75213  70.1%     -   25s
     0     0 7927.09465    0 7189 26286.0652 7927.09465  69.8%     -   29s
     0     0 8039.49025    0 6998 26286.0652 8039.49025  69.4%     -   32s
     0     0 8114.48137    0 7489 26286.0652 8114.48137  69.1%     -   34s
     0     0 8120.66902    0 7477 26286.0652 8120.66902  69.1%     -   35s
     0     0 8121.81378    0 7520 26286.0652 8121.81378  69.1%     -   35s
     0     0 8122.31963    0 7540 26286.0652 8122.31963  69.1%     -   36s
     0     0 8122.52704    0 7591 26286.0652 8122.52704  69.1%     -   37s
     0     0 8122.59704    0 7581 26286.0652 8122.59704  69.1%     -   37s
     0     0 8314.17651    0 3774 26286.0652 8314.17651  68.4%     -   50s
H    0     0                    24066.192702 8314.17651  65.5%     -   50s
     0     0 8395.41112    0 2316 24066.1927 8395.41112  65.1%     -   55s
     0     0 8395.46435    0 2269 24066.1927 8395.46435  65.1%     -   57s
     0     0 8479.91519    0 1133 24066.1927 8479.91519  64.8%     -   63s
H    0     0                    18322.483858 8479.91519  53.7%     -   63s
     0     0 8480.88434    0 1004 18322.4839 8480.88434  53.7%     -   66s
H    0     0                    18240.505723 8508.99820  53.4%     -   72s
     0     0 8508.99820    0  757 18240.5057 8508.99820  53.4%     -   72s
H    0     0                    10175.383103 8508.99820  16.4%     -   72s
H    0     0                    10128.197610 8508.99820  16.0%     -   72s
     0     0 8509.96269    0  718 10128.1976 8509.96269  16.0%     -   74s
     0     0 8526.72646    0  883 10128.1976 8526.72646  15.8%     -   80s
H    0     0                    9032.6413554 8526.72646  5.60%     -   80s
H    0     0                    8658.4624886 8526.72646  1.52%     -   83s

Cutting planes:
  Gomory: 99
  Lift-and-project: 161
  Flow cover: 2
  Zero half: 4481

Explored 1 nodes (122373 simplex iterations) in 83.62 seconds (86.89 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 8658.46 9032.64 10128.2 ... 36921.2

Optimal solution found (tolerance 5.00e-02)
Best objective 8.658462488647e+03, best bound 8.526726460235e+03, gap 1.5215%
coll_cache:optimal_local_rate=0.262473,0.246668,0.241992,0.259268,0.259262,0.23357,0.244667,0.264487,
coll_cache:optimal_remote_rate=0.717044,0.732849,0.737525,0.720249,0.720255,0.745947,0.73485,0.71503,
coll_cache:optimal_cpu_rate=0.0204829,0.0204829,0.0204829,0.0204829,0.0204829,0.0204829,0.0204829,0.0204829,
z=8658.46
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=9154893824
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.004250 | send           0.000000
        L1  recv             0.000000 | copy           0.010660 | convert time 0.000000 | train  0.007673
        L1  feature nbytes  563.38 MB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.010660
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.001034 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.009579 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.010641
        p90.00_tail_logl2featcopy=0.010879
        p95.00_tail_logl2featcopy=0.010975
        p99.00_tail_logl2featcopy=0.011168
        p99.90_tail_logl2featcopy=0.018066
[CUDA] cuda: usage: 17.56 GB
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005404, per step: 0.000043
presamping
presamping takes 12.413434028625488
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007666, per step: 0.000061
presamping
presamping takes 12.79972791671753
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004916, per step: 0.000039
presamping
presamping takes 11.814414262771606
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005272, per step: 0.000042
presamping
presamping takes 12.77980637550354
config:eval_tsp="2023-04-14 19:40:42"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=ogbn-papers100M
config:epochs=4
config:batchsize=2000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.16
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=172
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7fa2a4459400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004757, per step: 0.000038
epoch=4 total_steps=500
presamping
presamping takes 12.822807312011719
start training...
[Epoch 0], time=4.316943407058716, loss=0.6931472420692444
[Epoch 1], time=2.8066158294677734, loss=0.6931472420692444
[Epoch 2], time=2.8211252689361572, loss=0.6931472420692444
[Epoch 3], time=2.865452766418457, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   74816 KB |  416644 KB |  645850 MB |  645777 MB |
|       from large pool |   67804 KB |  410202 KB |  637697 MB |  637631 MB |
|       from small pool |    7012 KB |    8902 KB |    8152 MB |    8146 MB |
|---------------------------------------------------------------------------|
| Active memory         |   74816 KB |  416644 KB |  645850 MB |  645777 MB |
|       from large pool |   67804 KB |  410202 KB |  637697 MB |  637631 MB |
|       from small pool |    7012 KB |    8902 KB |    8152 MB |    8146 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |     980 MB |     980 MB |     980 MB |       0 B  |
|       from large pool |     968 MB |     968 MB |     968 MB |       0 B  |
|       from small pool |      12 MB |      12 MB |      12 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29632 KB |  482538 KB |  773231 MB |  773202 MB |
|       from large pool |   26404 KB |  479053 KB |  764759 MB |  764733 MB |
|       from small pool |    3228 KB |    6420 KB |    8471 MB |    8468 MB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102444    |  102386    |
|       from large pool |      11    |      21    |   31274    |   31263    |
|       from small pool |      47    |      58    |   71170    |   71123    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102444    |  102386    |
|       from large pool |      11    |      21    |   31274    |   31263    |
|       from small pool |      47    |      58    |   71170    |   71123    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |      11    |      11    |      11    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      26    |      37    |   35440    |   35414    |
|       from large pool |       8    |      14    |   16531    |   16523    |
|       from small pool |      18    |      26    |   18909    |   18891    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 12.812728 seconds
[EPOCH_TIME] 3.203182 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 2.843567 seconds
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004916, per step: 0.000039
presamping
presamping takes 11.18901801109314
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.008020, per step: 0.000064
presamping
presamping takes 12.452524662017822
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004984, per step: 0.000040
presamping
presamping takes 12.91457462310791

