succeed=True
[CUDA] cuda: usage: 5.60 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 105656 rows, 16409 columns and 246456 nonzeros
Model fingerprint: 0x1dca136b
Variable types: 9 continuous, 16400 integer (16400 binary)
Coefficient statistics:
  Matrix range     [5e-09, 1e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Presolve removed 89607 rows and 0 columns
Presolve time: 0.21s
Presolved: 16049 rows, 16409 columns, 64257 nonzeros
Variable types: 9 continuous, 16400 integer (16400 binary)
Found heuristic solution: objective 783766.08368
Found heuristic solution: objective 173274.26762

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24424    2.1048645e+04   6.859478e+03   0.000000e+00      5s
   28225    2.1048678e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 2.104868e+04, 28225 iterations, 6.51 seconds (7.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21048.6784    0 6593 173274.268 21048.6784  87.9%     -    7s
H    0     0                    173268.78260 21048.6784  87.9%     -    7s
H    0     0                    112167.55243 21048.6784  81.2%     -   11s
H    0     0                    64511.446564 22028.2219  65.9%     -   15s
     0     0 22028.2219    0 3139 64511.4466 22028.2219  65.9%     -   15s
H    0     0                    56285.388484 22028.2219  60.9%     -   16s
     0     0 22127.3838    0 2583 56285.3885 22127.3838  60.7%     -   17s
     0     0 22129.4713    0 2798 56285.3885 22129.4713  60.7%     -   18s
H    0     0                    55143.058895 22129.4713  59.9%     -   19s
     0     0 22130.5012    0 2806 55143.0589 22130.5012  59.9%     -   19s
     0     0 22130.6324    0 2814 55143.0589 22130.6324  59.9%     -   21s
H    0     0                    46870.079240 22130.6324  52.8%     -   21s
H    0     0                    45376.210311 22130.6324  51.2%     -   21s
H    0     0                    41893.682699 22130.6324  47.2%     -   21s
H    0     0                    40969.704264 22130.6324  46.0%     -   21s
     0     0 22130.6324    0 2769 40969.7043 22130.6324  46.0%     -   22s
     0     0 22130.7593    0 2801 40969.7043 22130.7593  46.0%     -   22s
     0     0 22131.0216    0 2722 40969.7043 22131.0216  46.0%     -   23s
H    0     0                    33001.000453 22208.4796  32.7%     -   30s
     0     0 22208.4796    0 1932 33001.0005 22208.4796  32.7%     -   30s
H    0     0                    31851.154191 22208.4796  30.3%     -   30s
     0     0 22219.2971    0 1617 31851.1542 22219.2971  30.2%     -   31s
     0     0 22219.9745    0 1595 31851.1542 22219.9745  30.2%     -   31s
     0     0 22220.1761    0 1549 31851.1542 22220.1761  30.2%     -   31s
     0     0 22257.4884    0 1467 31851.1542 22257.4884  30.1%     -   37s
H    0     0                    24036.608323 22257.4884  7.40%     -   40s
     0     0 22257.4885    0 1352 24036.6083 22257.4885  7.40%     -   40s
     0     0 22284.5832    0  917 24036.6083 22284.5832  7.29%     -   45s
H    0     0                    23923.445113 22284.5832  6.85%     -   46s
     0     0 22284.5833    0  861 23923.4451 22284.5833  6.85%     -   47s
     0     0 22284.5869    0  583 23923.4451 22284.5869  6.85%     -   55s
H    0     0                    22740.574727 22284.5869  2.01%     -   63s

Cutting planes:
  Gomory: 130
  Lift-and-project: 194
  MIR: 4
  Flow cover: 2
  Zero half: 2167

Explored 1 nodes (94429 simplex iterations) in 63.51 seconds (58.16 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 22740.6 23923.4 24036.6 ... 55143.1

Optimal solution found (tolerance 5.00e-02)
Best objective 2.274057472704e+04, best bound 2.228458689919e+04, gap 2.0052%
coll_cache:optimal_local_rate=0.531177,0.522858,0.526711,0.521207,0.526969,0.526838,0.530285,0.528645,
coll_cache:optimal_remote_rate=0.45997,0.468289,0.464436,0.46994,0.464178,0.464309,0.460862,0.462502,
coll_cache:optimal_cpu_rate=0.0088532,0.0088532,0.0088532,0.0088532,0.0088532,0.0088532,0.0088532,0.0088532,
z=22740.6
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=14272536576
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=14272536576
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=14272536576
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=14272536576
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=14272536576
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=14272536576
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=14272536576
test_result:init:feat_nbytes=56862697472
test_result:init:cache_nbytes=14272536576
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.014465 | send           0.000000
        L1  recv             0.000000 | copy           0.025541 | convert time 0.000000 | train  0.024118
        L1  feature nbytes    2.03 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.025541
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.003486 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.022012 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.025427
        p90.00_tail_logl2featcopy=0.027648
        p95.00_tail_logl2featcopy=0.027859
        p99.00_tail_logl2featcopy=0.028296
        p99.90_tail_logl2featcopy=0.045381
[CUDA] cuda: usage: 28.66 GB
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.021177, per step: 0.000169
presamping
presamping takes 38.02796411514282
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.010407, per step: 0.000083
presamping
presamping takes 36.95749855041504
config:eval_tsp="2023-04-14 10:42:14"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=ogbn-papers100M
config:epochs=4
config:batchsize=8000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.25
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=172
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7fa4a0705400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007171, per step: 0.000057
epoch=4 total_steps=500
presamping
presamping takes 38.08733510971069
start training...
[Epoch 0], time=9.53573751449585, loss=0.6931472420692444
[Epoch 1], time=7.993854999542236, loss=0.6931472420692444
[Epoch 2], time=8.027010679244995, loss=0.6931472420692444
[Epoch 3], time=8.051238775253296, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  272339 KB |    1500 MB |    2336 GB |    2336 GB |
|       from large pool |  259188 KB |    1488 MB |    2322 GB |    2321 GB |
|       from small pool |   13151 KB |      18 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Active memory         |  272339 KB |    1500 MB |    2336 GB |    2336 GB |
|       from large pool |  259188 KB |    1488 MB |    2322 GB |    2321 GB |
|       from small pool |   13151 KB |      18 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5852 MB |    5852 MB |    5852 MB |       0 B  |
|       from large pool |    5826 MB |    5826 MB |    5826 MB |       0 B  |
|       from small pool |      26 MB |      26 MB |      26 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   84012 KB |    1274 MB |    2073 GB |    2073 GB |
|       from large pool |   76683 KB |    1265 MB |    2058 GB |    2058 GB |
|       from small pool |    7329 KB |      13 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102450    |  102392    |
|       from large pool |      13    |      24    |   38784    |   38771    |
|       from small pool |      45    |      54    |   63666    |   63621    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102450    |  102392    |
|       from large pool |      13    |      24    |   38784    |   38771    |
|       from small pool |      45    |      54    |   63666    |   63621    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      35    |      35    |       0    |
|       from large pool |      22    |      22    |      22    |       0    |
|       from small pool |      13    |      13    |      13    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      26    |      42    |   34487    |   34461    |
|       from large pool |       5    |      18    |   18243    |   18238    |
|       from small pool |      21    |      28    |   16244    |   16223    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 33.609597 seconds
[EPOCH_TIME] 8.402399 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 8.039370 seconds
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007929, per step: 0.000063
presamping
presamping takes 36.90797781944275
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007519, per step: 0.000060
presamping
presamping takes 34.26912498474121
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.021172, per step: 0.000169
presamping
presamping takes 37.7047803401947
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.011086, per step: 0.000089
presamping
presamping takes 37.03536128997803
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007741, per step: 0.000062
presamping
presamping takes 37.165183782577515

