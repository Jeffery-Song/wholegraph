succeed=True
[CUDA] cuda: usage: 5.53 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 200168 rows, 31087 columns and 466984 nonzeros
Model fingerprint: 0xe77c6f79
Variable types: 9 continuous, 31078 integer (31078 binary)
Coefficient statistics:
  Matrix range     [2e-09, 7e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 79127.963954
Presolve removed 170295 rows and 492 columns
Presolve time: 0.47s
Presolved: 29873 rows, 30595 columns, 108107 nonzeros
Variable types: 9 continuous, 30586 integer (30586 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.11s

Solved with primal simplex

Root relaxation: objective 4.194835e+04, 4817 iterations, 0.39 seconds (0.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41948.3454    0 11281 79127.9640 41948.3454  47.0%     -    1s
H    0     0                    74471.329854 41948.3454  43.7%     -    1s
H    0     0                    61207.612611 41948.3454  31.5%     -    4s
H    0     0                    57815.230724 41948.3454  27.4%     -    4s
H    0     0                    55784.168283 41948.3454  24.8%     -    4s
     0     0 43237.4329    0 8669 55784.1683 43237.4329  22.5%     -    6s
H    0     0                    49646.144529 43237.4329  12.9%     -    9s
     0     0 43592.6687    0 7992 49646.1445 43592.6687  12.2%     -    9s
     0     0 43592.6687    0 7998 49646.1445 43592.6687  12.2%     -   10s
     0     0 43953.6142    0 8238 49646.1445 43953.6142  11.5%     -   14s
H    0     0                    49109.228718 43953.6142  10.5%     -   15s
H    0     0                    48740.939409 44585.2221  8.53%     -   16s
H    0     0                    48567.063280 44585.2221  8.20%     -   16s
H    0     0                    48305.247757 44585.2221  7.70%     -   16s
H    0     0                    48302.742534 44585.2221  7.70%     -   16s
     0     0 44585.2221    0 7402 48302.7425 44585.2221  7.70%     -   17s
H    0     0                    48129.580575 44769.0635  6.98%     -   18s
     0     0 44769.0635    0 6600 48129.5806 44769.0635  6.98%     -   18s
     0     0 44866.2077    0 6735 48129.5806 44866.2077  6.78%     -   19s
H    0     0                    48129.572468 45018.4295  6.46%     -   21s
     0     0 45018.4295    0 6758 48129.5725 45018.4295  6.46%     -   21s
     0     0 45587.4144    0 4859 48129.5725 45587.4144  5.28%     -   23s
     0     0 45734.1808    0 4467 48129.5725 45734.1808  4.98%     -   23s

Cutting planes:
  Gomory: 142
  Lift-and-project: 10
  MIR: 1
  Flow cover: 3
  Zero half: 6948
  Mod-K: 1767

Explored 1 nodes (42547 simplex iterations) in 23.95 seconds (19.25 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 48129.6 48129.6 48302.7 ... 57815.2

Optimal solution found (tolerance 5.00e-02)
Best objective 4.812957246844e+04, best bound 4.573418084397e+04, gap 4.9770%
coll_cache:optimal_local_rate=0.100206,0.0937332,0.111609,0.123835,0.0983151,0.103296,0.109706,0.124024,
coll_cache:optimal_remote_rate=0.31981,0.326282,0.308407,0.296181,0.3217,0.31672,0.310309,0.295991,
coll_cache:optimal_cpu_rate=0.579984,0.579984,0.579984,0.579984,0.579984,0.579984,0.579984,0.579984,
z=48129.6
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.003682 | send           0.000000
        L1  recv             0.000000 | copy           0.185840 | convert time 0.000000 | train  0.037911
        L1  feature nbytes    1.36 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.185840
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.000689 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.185092 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.199341
        p90.00_tail_logl2featcopy=0.201755
        p95.00_tail_logl2featcopy=0.202508
        p99.00_tail_logl2featcopy=0.204590
        p99.90_tail_logl2featcopy=0.214393
[CUDA] cuda: usage: 14.15 GB
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006095, per step: 0.000049
presamping
presamping takes 11.539850950241089
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007654, per step: 0.000061
presamping
presamping takes 11.195470333099365
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007002, per step: 0.000056
presamping
presamping takes 11.584798574447632
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004827, per step: 0.000039
presamping
presamping takes 11.603284120559692
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005424, per step: 0.000043
presamping
presamping takes 11.428156614303589
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005542, per step: 0.000044
presamping
presamping takes 10.561129570007324
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006050, per step: 0.000048
presamping
presamping takes 8.06863784790039
config:eval_tsp="2023-04-15 05:17:58"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=mag240m-homo
config:epochs=4
config:batchsize=2000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.01
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=153
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7f1d6b175400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004860, per step: 0.000039
epoch=4 total_steps=500
presamping
presamping takes 11.379884481430054
start training...
[Epoch 0], time=29.876161813735962, loss=0.6931472420692444
[Epoch 1], time=28.422000885009766, loss=0.6931472420692444
[Epoch 2], time=28.467755556106567, loss=0.6931472420692444
[Epoch 3], time=28.423821687698364, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   87935 KB |  722163 KB |     968 GB |     968 GB |
|       from large pool |   76134 KB |  710963 KB |     958 GB |     958 GB |
|       from small pool |   11801 KB |   14129 KB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Active memory         |   87935 KB |  722163 KB |     968 GB |     968 GB |
|       from large pool |   76134 KB |  710963 KB |     958 GB |     958 GB |
|       from small pool |   11801 KB |   14129 KB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2794 MB |    2794 MB |    2794 MB |       0 B  |
|       from large pool |    2776 MB |    2776 MB |    2776 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49281 KB |    1056 MB |  716885 MB |  716837 MB |
|       from large pool |   46746 KB |    1053 MB |  706441 MB |  706395 MB |
|       from small pool |    2535 KB |       5 MB |   10444 MB |   10442 MB |
|---------------------------------------------------------------------------|
| Allocations           |      62    |      81    |  106949    |  106887    |
|       from large pool |      15    |      26    |   35781    |   35766    |
|       from small pool |      47    |      58    |   71168    |   71121    |
|---------------------------------------------------------------------------|
| Active allocs         |      62    |      81    |  106949    |  106887    |
|       from large pool |      15    |      26    |   35781    |   35766    |
|       from small pool |      47    |      58    |   71168    |   71121    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |      25    |      25    |       0    |
|       from large pool |      16    |      16    |      16    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |      38    |   40213    |   40185    |
|       from large pool |       9    |      18    |   20982    |   20973    |
|       from small pool |      19    |      27    |   19231    |   19212    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 115.192448 seconds
[EPOCH_TIME] 28.798112 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 28.446011 seconds

