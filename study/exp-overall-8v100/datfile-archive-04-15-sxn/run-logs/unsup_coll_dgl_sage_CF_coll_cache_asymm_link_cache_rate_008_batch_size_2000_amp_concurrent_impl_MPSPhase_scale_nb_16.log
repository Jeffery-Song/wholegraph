succeed=True
[CUDA] cuda: usage: 5.23 GB
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
0 : local 72, cpu 8 {link #0 : g3 24}, {link #1 : g6 24}, {link #2 : g1 12}, {link #3 : g2 12},
1 : local 72, cpu 8 {link #0 : g7 24}, {link #1 : g2 24}, {link #2 : g3 12}, {link #3 : g0 12},
2 : local 72, cpu 8 {link #0 : g1 24}, {link #1 : g3 24}, {link #2 : g0 12}, {link #3 : g4 12},
3 : local 72, cpu 8 {link #0 : g2 24}, {link #1 : g0 24}, {link #2 : g5 12}, {link #3 : g1 12},
4 : local 72, cpu 8 {link #0 : g5 24}, {link #1 : g7 24}, {link #2 : g2 12}, {link #3 : g6 12},
5 : local 72, cpu 8 {link #0 : g6 24}, {link #1 : g4 24}, {link #2 : g7 12}, {link #3 : g3 12},
6 : local 72, cpu 8 {link #0 : g0 24}, {link #1 : g5 24}, {link #2 : g4 12}, {link #3 : g7 12},
7 : local 72, cpu 8 {link #0 : g4 24}, {link #1 : g1 24}, {link #2 : g6 12}, {link #3 : g5 12},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 159256 rows, 24732 columns and 400448 nonzeros
Model fingerprint: 0xb1ed3582
Variable types: 9 continuous, 24723 integer (24723 binary)
Coefficient statistics:
  Matrix range     [8e-09, 4e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 6e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 2.000000e+09
Presolve removed 135086 rows and 7 columns
Presolve time: 0.48s
Presolved: 24170 rows, 24725 columns, 117070 nonzeros
Found heuristic solution: objective 343451.95156
Variable types: 1 continuous, 24724 integer (24723 binary)

Deterministic concurrent LP optimizer: primal and dual simplex
Showing first log only...


Use crossover to convert LP symmetric solution to basic solution...
Concurrent spin time: 0.00s

Solved with primal simplex

Root relaxation: objective 2.812199e+04, 3611 iterations, 0.23 seconds (0.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28121.9896    0 11241 343451.952 28121.9896  91.8%     -    1s
H    0     0                    332396.28135 28121.9896  91.5%     -    1s
H    0     0                    160244.12476 28121.9896  82.5%     -    1s
H    0     0                    156728.70775 28121.9896  82.1%     -    3s
H    0     0                    153320.08125 35475.8609  76.9%     -    5s
     0     0 35475.8609    0 6914 153320.081 35475.8609  76.9%     -    5s
H    0     0                    118658.80419 35475.8609  70.1%     -    6s
H    0     0                    104735.18885 35475.8609  66.1%     -    6s
     0     0 37035.9019    0 6765 104735.189 37035.9019  64.6%     -    6s
     0     0 38259.0309    0 6944 104735.189 38259.0309  63.5%     -    7s
     0     0 38259.0309    0 6975 104735.189 38259.0309  63.5%     -    7s
     0     0 38459.6534    0 6688 104735.189 38459.6534  63.3%     -   10s
H    0     0                    89352.183983 38459.6534  57.0%     -   10s
     0     0 39498.1701    0 5885 89352.1840 39498.1701  55.8%     -   11s
     0     0 40794.0772    0 4333 89352.1840 40794.0772  54.3%     -   11s
     0     0 41955.8375    0 3737 89352.1840 41955.8375  53.0%     -   12s
     0     0 42112.5997    0 3720 89352.1840 42112.5997  52.9%     -   12s
     0     0 42153.8418    0 3721 89352.1840 42153.8418  52.8%     -   13s
     0     0 42172.8668    0 3696 89352.1840 42172.8668  52.8%     -   14s
     0     0 42190.3091    0 3755 89352.1840 42190.3091  52.8%     -   14s
     0     0 42196.5431    0 3740 89352.1840 42196.5431  52.8%     -   15s
     0     0 42198.8457    0 3760 89352.1840 42198.8457  52.8%     -   15s
H    0     0                    87291.146748 43586.7150  50.1%     -   17s
     0     0 43586.7150    0 1675 87291.1467 43586.7150  50.1%     -   17s
H    0     0                    86045.732405 43586.7150  49.3%     -   17s
H    0     0                    74401.762022 43586.7150  41.4%     -   17s
H    0     0                    43964.197900 43586.7150  0.86%     -   19s

Cutting planes:
  Gomory: 160
  Lift-and-project: 17
  MIR: 7
  Flow cover: 17
  Zero half: 3649
  Mod-K: 1627

Explored 1 nodes (32440 simplex iterations) in 19.96 seconds (16.34 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 43964.2 74401.8 86045.7 ... 160244

Optimal solution found (tolerance 5.00e-02)
Best objective 4.396419790020e+04, best bound 4.358671498890e+04, gap 0.8586%
coll_cache:optimal_local_rate=0.253887,0.186969,0.213814,0.252582,0.246966,0.256444,0.181366,0.222475,
coll_cache:optimal_remote_rate=0.653365,0.720282,0.693438,0.65467,0.660286,0.650807,0.725886,0.684776,
coll_cache:optimal_cpu_rate=0.0927482,0.0927482,0.0927482,0.0927482,0.0927482,0.0927482,0.0927482,0.0927482,
z=43964.2
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=5441819648
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.004743 | send           0.000000
        L1  recv             0.000000 | copy           0.027535 | convert time 0.000000 | train  0.011204
        L1  feature nbytes    1.19 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes     116.90 MB | remote nbytes  823.46 MB
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.027535
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.001119 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.026338 | cache combine cache 0.004150 | cache combine remote 0.008166
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.027569
        p90.00_tail_logl2featcopy=0.028949
        p95.00_tail_logl2featcopy=0.029571
        p99.00_tail_logl2featcopy=0.030263
        p99.90_tail_logl2featcopy=0.041254
[CUDA] cuda: usage: 16.37 GB
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005320, per step: 0.000043
presamping
presamping takes 11.602437496185303
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006213, per step: 0.000050
presamping
presamping takes 12.169998168945312
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007612, per step: 0.000061
presamping
presamping takes 11.570399284362793
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005085, per step: 0.000041
presamping
presamping takes 11.535472631454468
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005353, per step: 0.000043
presamping
presamping takes 11.809290885925293
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004688, per step: 0.000038
presamping
presamping takes 11.585341453552246
config:eval_tsp="2023-04-15 01:32:56"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=com-friendster
config:epochs=4
config:batchsize=2000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.08
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=100
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7fd49a703400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.004635, per step: 0.000037
epoch=4 total_steps=500
presamping
presamping takes 11.581693887710571
start training...
[Epoch 0], time=6.953446865081787, loss=0.6931472420692444
[Epoch 1], time=5.477121829986572, loss=0.6931472420692444
[Epoch 2], time=5.410313606262207, loss=0.6931472420692444
[Epoch 3], time=5.44609522819519, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   81870 KB |  781777 KB |     818 GB |     818 GB |
|       from large pool |   74576 KB |  775321 KB |     810 GB |     810 GB |
|       from small pool |    7293 KB |    9035 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |   81870 KB |  781777 KB |     818 GB |     818 GB |
|       from large pool |   74576 KB |  775321 KB |     810 GB |     810 GB |
|       from small pool |    7293 KB |    9035 KB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2074 MB |    2074 MB |    2074 MB |       0 B  |
|       from large pool |    2062 MB |    2062 MB |    2062 MB |       0 B  |
|       from small pool |      12 MB |      12 MB |      12 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   47154 KB |  719928 KB |  723395 MB |  723349 MB |
|       from large pool |   44207 KB |  716431 KB |  714483 MB |  714440 MB |
|       from small pool |    2946 KB |    6387 KB |    8912 MB |    8909 MB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102447    |  102389    |
|       from large pool |      12    |      22    |   31281    |   31269    |
|       from small pool |      46    |      57    |   71166    |   71120    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102447    |  102389    |
|       from large pool |      12    |      22    |   31281    |   31269    |
|       from small pool |      46    |      57    |   71166    |   71120    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      21    |      37    |   36763    |   36742    |
|       from large pool |       8    |      19    |   18611    |   18603    |
|       from small pool |      13    |      24    |   18152    |   18139    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 23.288733 seconds
[EPOCH_TIME] 5.822183 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 5.428477 seconds
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007528, per step: 0.000060
presamping
presamping takes 11.886502265930176

