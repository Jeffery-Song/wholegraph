succeed=True
[CUDA] cuda: usage: 5.45 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 138128 rows, 21452 columns and 322224 nonzeros
Model fingerprint: 0xd7327cbd
Variable types: 9 continuous, 21443 integer (21443 binary)
Coefficient statistics:
  Matrix range     [2e-09, 2e+02]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 11783.009774
Presolve removed 117519 rows and 369 columns
Presolve time: 0.33s
Presolved: 20609 rows, 21083 columns, 82659 nonzeros
Variable types: 9 continuous, 21074 integer (21074 binary)

Root relaxation: objective 9.662259e+02, 33183 iterations, 3.55 seconds (3.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  966.22591    0 10761 11783.0098  966.22591  91.8%     -    4s
H    0     0                    8265.7381409  966.22591  88.3%     -    7s
H    0     0                    6137.2265287  966.22591  84.3%     -    7s
H    0     0                    5494.3047535  966.22591  82.4%     -    7s
H    0     0                    4236.3444342  966.22591  77.2%     -    7s
H    0     0                    3817.9357411  966.22591  74.7%     -    7s
H    0     0                    3539.1581489 1099.09140  68.9%     -    9s
     0     0 1167.32645    0 8427 3539.15815 1167.32645  67.0%     -    9s
H    0     0                    3459.1363042 1167.32645  66.3%     -   12s
     0     0 1170.85546    0 7864 3459.13630 1170.85546  66.2%     -   13s
     0     0 1170.85546    0 8356 3459.13630 1170.85546  66.2%     -   14s
     0     0 1176.54984    0 8960 3459.13630 1176.54984  66.0%     -   15s
H    0     0                    3245.1029957 1195.74341  63.2%     -   15s
     0     0 1195.74341    0 8535 3245.10300 1195.74341  63.2%     -   15s
H    0     0                    3209.0852519 1212.18582  62.2%     -   16s
     0     0 1212.18582    0 8460 3209.08525 1212.18582  62.2%     -   16s
     0     0 1213.45632    0 8532 3209.08525 1213.45632  62.2%     -   17s
     0     0 1214.51263    0 8542 3209.08525 1214.51263  62.2%     -   17s
     0     0 1215.39645    0 8598 3209.08525 1215.39645  62.1%     -   18s
     0     0 1216.18300    0 8553 3209.08525 1216.18300  62.1%     -   18s
     0     0 1216.68360    0 8588 3209.08525 1216.68360  62.1%     -   19s
     0     0 1217.09394    0 8581 3209.08525 1217.09394  62.1%     -   19s
     0     0 1217.27768    0 8565 3209.08525 1217.27768  62.1%     -   19s
     0     0 1217.32363    0 8555 3209.08525 1217.32363  62.1%     -   19s
     0     0 1217.38428    0 8534 3209.08525 1217.38428  62.1%     -   19s
H    0     0                    2741.3031366 1316.60404  52.0%     -   27s
H    0     0                    1634.6864441 1316.60404  19.5%     -   27s
     0     0 1316.60404    0 1039 1634.68644 1316.60404  19.5%     -   27s
H    0     0                    1615.7925860 1316.60404  18.5%     -   27s
     0     0 1316.60404    0 1039 1615.79259 1316.60404  18.5%     -   27s
     0     0 1319.15849    0  790 1615.79259 1319.15849  18.4%     -   31s
H    0     0                    1464.4634633 1319.15849  9.92%     -   31s
     0     0 1319.15849    0  802 1464.46346 1319.15849  9.92%     -   32s
     0     0 1322.31595    0  422 1464.46346 1322.31595  9.71%     -   34s
H    0     0                    1440.0296962 1322.31595  8.17%     -   35s
H    0     0                    1389.9483448 1322.31595  4.87%     -   37s

Cutting planes:
  Gomory: 70
  Lift-and-project: 107
  Cover: 5
  MIR: 7
  StrongCG: 2
  Flow cover: 12
  Zero half: 6323

Explored 1 nodes (77425 simplex iterations) in 37.23 seconds (30.83 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 1389.95 1440.03 1464.46 ... 3539.16

Optimal solution found (tolerance 5.00e-02)
Best objective 1.389948344751e+03, best bound 1.322315950794e+03, gap 4.8658%
coll_cache:optimal_local_rate=0.306659,0.185296,0.243611,0.172351,0.218368,0.212355,0.257874,0.23515,
coll_cache:optimal_remote_rate=0.598198,0.719561,0.661246,0.732506,0.686489,0.692502,0.646983,0.669707,
coll_cache:optimal_cpu_rate=0.0951434,0.0951434,0.0951434,0.0951434,0.0951434,0.0951434,0.0951434,0.0951434,
z=1389.95
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
test_result:init:feat_nbytes=375030526464
test_result:init:cache_nbytes=4125335040
    [Step(average) Profiler Level 1 E3 S135]
        L1  sample           0.004054 | send           0.000000
        L1  recv             0.000000 | copy           0.048655 | convert time 0.000000 | train  0.025937
        L1  feature nbytes    1.51 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S135]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.048655
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S135]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.000908 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.047693 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S135]
        p50.00_tail_logl2featcopy=0.048860
        p90.00_tail_logl2featcopy=0.049903
        p95.00_tail_logl2featcopy=0.050201
        p99.00_tail_logl2featcopy=0.064885
        p99.90_tail_logl2featcopy=0.065653
[CUDA] cuda: usage: 13.30 GB
Rank=3, Graph loaded.
!!!!Train_dataloader(with 17 items) enumerate latency: 0.3587357997894287
!!!!Train_data_list(with 17 items) enumerate latency: 5.4836273193359375e-06, transfer latency: 0.26911449432373047
presamping
presamping takes 1.6229801177978516
Rank=2, Graph loaded.
!!!!Train_dataloader(with 17 items) enumerate latency: 0.36861181259155273
!!!!Train_data_list(with 17 items) enumerate latency: 5.7220458984375e-06, transfer latency: 0.2761867046356201
presamping
presamping takes 1.7208104133605957
config:eval_tsp="2023-04-15 07:31:30"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=mag240m-homo
config:epochs=4
config:batchsize=8000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.01
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=False
config:classnum=153
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7f9200d363d0>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!Train_dataloader(with 17 items) enumerate latency: 0.391599178314209
!!!!Train_data_list(with 17 items) enumerate latency: 6.4373016357421875e-06, transfer latency: 0.29822492599487305
epoch=4 total_steps=68
presamping
presamping takes 1.779289960861206
start training...
[Epoch 0], time=2.9005112648010254, loss=4.987063884735107
[Epoch 1], time=1.3406455516815186, loss=4.943554878234863
[Epoch 2], time=1.334735631942749, loss=4.902807235717773
[Epoch 3], time=1.3400938510894775, loss=4.864713191986084
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   95744 KB |  782596 KB |  152713 MB |  152620 MB |
|       from large pool |   84128 KB |  771180 KB |  151223 MB |  151141 MB |
|       from small pool |   11616 KB |   13953 KB |    1489 MB |    1478 MB |
|---------------------------------------------------------------------------|
| Active memory         |   95744 KB |  782596 KB |  152713 MB |  152620 MB |
|       from large pool |   84128 KB |  771180 KB |  151223 MB |  151141 MB |
|       from small pool |   11616 KB |   13953 KB |    1489 MB |    1478 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1988 MB |    1988 MB |    1988 MB |       0 B  |
|       from large pool |    1970 MB |    1970 MB |    1970 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   55808 KB |  626331 KB |   96639 MB |   96584 MB |
|       from large pool |   53088 KB |  623381 KB |   95021 MB |   94969 MB |
|       from small pool |    2720 KB |    6067 KB |    1617 MB |    1614 MB |
|---------------------------------------------------------------------------|
| Allocations           |      59    |      76    |   11460    |   11401    |
|       from large pool |      15    |      27    |    4481    |    4466    |
|       from small pool |      44    |      51    |    6979    |    6935    |
|---------------------------------------------------------------------------|
| Active allocs         |      59    |      76    |   11460    |   11401    |
|       from large pool |      15    |      27    |    4481    |    4466    |
|       from small pool |      44    |      51    |    6979    |    6935    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |      27    |      27    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |      38    |    4869    |    4841    |
|       from large pool |       9    |      17    |    2802    |    2793    |
|       from small pool |      19    |      26    |    2067    |    2048    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 6.917281 seconds
[EPOCH_TIME] 1.729320 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 1.337695 seconds
Rank=6, Graph loaded.
!!!!Train_dataloader(with 17 items) enumerate latency: 0.3373596668243408
!!!!Train_data_list(with 17 items) enumerate latency: 4.5299530029296875e-06, transfer latency: 0.2487022876739502
presamping
presamping takes 1.7275049686431885
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!Train_dataloader(with 17 items) enumerate latency: 0.3605177402496338
!!!!Train_data_list(with 17 items) enumerate latency: 5.4836273193359375e-06, transfer latency: 0.2745072841644287
presamping
presamping takes 1.7123703956604004
Rank=5, Graph loaded.
!!!!Train_dataloader(with 17 items) enumerate latency: 0.3780965805053711
!!!!Train_data_list(with 17 items) enumerate latency: 5.4836273193359375e-06, transfer latency: 0.281017541885376
presamping
presamping takes 1.7954227924346924
Rank=7, Graph loaded.
!!!!Train_dataloader(with 17 items) enumerate latency: 0.39864087104797363
!!!!Train_data_list(with 17 items) enumerate latency: 6.9141387939453125e-06, transfer latency: 0.3021242618560791
presamping
presamping takes 1.715580701828003
Rank=1, Graph loaded.
!!!!Train_dataloader(with 17 items) enumerate latency: 0.3846557140350342
!!!!Train_data_list(with 17 items) enumerate latency: 6.67572021484375e-06, transfer latency: 0.2897782325744629
presamping
presamping takes 1.774489402770996

