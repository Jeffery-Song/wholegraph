succeed=True
[CUDA] cuda: usage: 5.32 GB
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
0 : local 80, cpu 0 {link #0 : g3 0}, {link #1 : g6 0}, {link #2 : g1 0}, {link #3 : g2 0},
1 : local 80, cpu 0 {link #0 : g7 0}, {link #1 : g2 0}, {link #2 : g3 0}, {link #3 : g0 0},
2 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g3 0}, {link #2 : g0 0}, {link #3 : g4 0},
3 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0}, {link #2 : g5 0}, {link #3 : g1 0},
4 : local 80, cpu 0 {link #0 : g5 0}, {link #1 : g7 0}, {link #2 : g2 0}, {link #3 : g6 0},
5 : local 80, cpu 0 {link #0 : g6 0}, {link #1 : g4 0}, {link #2 : g7 0}, {link #3 : g3 0},
6 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g5 0}, {link #2 : g4 0}, {link #3 : g7 0},
7 : local 80, cpu 0 {link #0 : g4 0}, {link #1 : g1 0}, {link #2 : g6 0}, {link #3 : g5 0},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter ScaleFlag to value 1
Set parameter DegenMoves to value 2
Set parameter Cuts to value 2
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 48
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (linux64)
Thread count: 48 physical cores, 96 logical processors, using up to 48 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 137072 rows, 21288 columns and 319760 nonzeros
Model fingerprint: 0x11853d20
Variable types: 9 continuous, 21279 integer (21279 binary)
Coefficient statistics:
  Matrix range     [8e-09, 2e+04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+04]
Warning: Model contains large matrix coefficient range
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.
Found heuristic solution: objective 713507.27069
Presolve removed 116423 rows and 164 columns
Presolve time: 0.32s
Presolved: 20649 rows, 21124 columns, 82860 nonzeros
Variable types: 9 continuous, 21115 integer (21115 binary)

Root relaxation: objective 1.777990e+05, 24855 iterations, 1.12 seconds (1.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 177798.987    0 10681 713507.271 177798.987  75.1%     -    1s
H    0     0                    704337.60999 177798.987  74.8%     -    1s
H    0     0                    403804.35807 177798.987  56.0%     -    1s
H    0     0                    390523.14650 177798.987  54.5%     -    3s
H    0     0                    367626.21725 177798.987  51.6%     -    3s
H    0     0                    359458.54925 192004.236  46.6%     -    5s
H    0     0                    344081.64727 192004.236  44.2%     -    6s
     0     0 196653.762    0 7764 344081.647 196653.762  42.8%     -    7s
H    0     0                    316533.28000 196653.762  37.9%     -    9s
H    0     0                    314216.75128 196653.762  37.4%     -   10s
     0     0 196653.768    0 5773 314216.751 196653.768  37.4%     -   10s
     0     0 196653.768    0 5758 314216.751 196653.768  37.4%     -   10s
     0     0 196653.768    0 5750 314216.751 196653.768  37.4%     -   10s
H    0     0                    300283.38084 196653.768  34.5%     -   13s
H    0     0                    290482.39446 196653.768  32.3%     -   13s
     0     0 207189.083    0 6760 290482.394 207189.083  28.7%     -   14s
H    0     0                    273623.04221 207189.083  24.3%     -   14s
     0     0 210303.085    0 6472 273623.042 210303.085  23.1%     -   15s
     0     0 210784.190    0 7073 273623.042 210784.190  23.0%     -   16s
     0     0 212432.283    0 7236 273623.042 212432.283  22.4%     -   17s
     0     0 212662.120    0 7377 273623.042 212662.120  22.3%     -   18s
     0     0 212928.219    0 7339 273623.042 212928.219  22.2%     -   18s
     0     0 213061.205    0 7337 273623.042 213061.205  22.1%     -   19s
H    0     0                    267433.42328 213112.330  20.3%     -   19s
     0     0 213112.330    0 7335 267433.423 213112.330  20.3%     -   19s
     0     0 213147.208    0 7336 267433.423 213147.208  20.3%     -   20s
H    0     0                    262669.17835 213169.358  18.8%     -   20s
     0     0 213169.358    0 7323 262669.178 213169.358  18.8%     -   20s
     0     0 213172.797    0 7337 262669.178 213172.797  18.8%     -   21s
H    0     0                    261289.85132 213172.797  18.4%     -   25s
H    0     0                    260601.34708 213172.797  18.2%     -   25s
     0     0 224000.846    0 1585 260601.347 224000.846  14.0%     -   26s
H    0     0                    247216.21976 224000.846  9.39%     -   27s
     0     0 224205.165    0 1399 247216.220 224205.165  9.31%     -   27s
     0     0 224221.565    0 1223 247216.220 224221.565  9.30%     -   27s
     0     0 225307.498    0  422 247216.220 225307.498  8.86%     -   31s
H    0     0                    230764.51452 225307.498  2.36%     -   32s

Cutting planes:
  Gomory: 218
  Lift-and-project: 166
  MIR: 171
  Flow cover: 23
  Zero half: 2996
  Mod-K: 1457

Explored 1 nodes (71377 simplex iterations) in 32.16 seconds (26.43 work units)
Thread count was 48 (of 96 available processors)

Solution count 10: 230765 247216 260601 ... 314217

Optimal solution found (tolerance 5.00e-02)
Best objective 2.307645145227e+05, best bound 2.253074977946e+05, gap 2.3648%
coll_cache:optimal_local_rate=0.189754,0.162548,0.19567,0.162512,0.154815,0.197026,0.172269,0.18437,
coll_cache:optimal_remote_rate=0.513076,0.540282,0.50716,0.540318,0.548015,0.505804,0.530561,0.51846,
coll_cache:optimal_cpu_rate=0.29717,0.29717,0.29717,0.29717,0.29717,0.29717,0.29717,0.29717,
z=230765
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=2754501632
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=2754501632
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=2754501632
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=2754501632
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=2754501632
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=2754501632
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=2754501632
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=2754501632
    [Step(average) Profiler Level 1 E3 S999]
        L1  sample           0.008258 | send           0.000000
        L1  recv             0.000000 | copy           0.125673 | convert time 0.000000 | train  0.025411
        L1  feature nbytes    2.21 GB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.125673
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.001732 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.123878 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S999]
        p50.00_tail_logl2featcopy=0.125330
        p90.00_tail_logl2featcopy=0.134256
        p95.00_tail_logl2featcopy=0.135046
        p99.00_tail_logl2featcopy=0.136105
        p99.90_tail_logl2featcopy=0.148089
[CUDA] cuda: usage: 15.45 GB
Rank=5, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007563, per step: 0.000061
presamping
presamping takes 19.132995128631592
Rank=7, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005824, per step: 0.000047
presamping
presamping takes 19.00824499130249
Rank=2, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.008918, per step: 0.000071
presamping
presamping takes 20.14350652694702
creating_intra_node_communicator root=4, local_size=4, world_size=8
Rank=4, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.007329, per step: 0.000059
presamping
presamping takes 19.67084050178528
Rank=6, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.006628, per step: 0.000053
presamping
presamping takes 19.61715841293335
config:eval_tsp="2023-04-15 03:47:07"
config:num_worker=8
config:num_intra_size=4
config:root_dir=/nvme/songxiaoniu/graph-learning/wholegraph
config:graph_name=com-friendster
config:epochs=4
config:batchsize=4000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=10,25
config:hiddensize=256
config:num_layer=2
config:model=sage
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:lr=0.003
config:use_nccl=False
config:use_amp=True
config:use_collcache=True
config:cache_percentage=0.04
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=48
config:unsupervised=True
config:classnum=100
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7fc41138e400>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=4, world_size=8
Rank=0, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.005590, per step: 0.000045
epoch=4 total_steps=500
presamping
presamping takes 19.508206605911255
start training...
[Epoch 0], time=21.428130388259888, loss=0.6931472420692444
[Epoch 1], time=19.94918727874756, loss=0.6931472420692444
[Epoch 2], time=19.917362928390503, loss=0.6931472420692444
[Epoch 3], time=19.91279149055481, loss=0.6931472420692444
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  150334 KB |    1428 MB |    1551 GB |    1551 GB |
|       from large pool |  139955 KB |    1418 MB |    1537 GB |    1537 GB |
|       from small pool |   10379 KB |      14 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Active memory         |  150334 KB |    1428 MB |    1551 GB |    1551 GB |
|       from large pool |  139955 KB |    1418 MB |    1537 GB |    1537 GB |
|       from small pool |   10379 KB |      14 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4952 MB |    4952 MB |    4952 MB |       0 B  |
|       from large pool |    4932 MB |    4932 MB |    4932 MB |       0 B  |
|       from small pool |      20 MB |      20 MB |      20 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   40129 KB |    1223 MB |    1307 GB |    1307 GB |
|       from large pool |   34125 KB |    1217 MB |    1293 GB |    1293 GB |
|       from small pool |    6004 KB |       9 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Allocations           |      58    |      74    |  102436    |  102378    |
|       from large pool |      12    |      22    |   32269    |   32257    |
|       from small pool |      46    |      57    |   70167    |   70121    |
|---------------------------------------------------------------------------|
| Active allocs         |      58    |      74    |  102436    |  102378    |
|       from large pool |      12    |      22    |   32269    |   32257    |
|       from small pool |      46    |      57    |   70167    |   70121    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      29    |      29    |      29    |       0    |
|       from large pool |      19    |      19    |      19    |       0    |
|       from small pool |      10    |      10    |      10    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |      40    |   36566    |   36537    |
|       from large pool |       9    |      19    |   17979    |   17970    |
|       from small pool |      20    |      27    |   18587    |   18567    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 81.209299 seconds
[EPOCH_TIME] 20.302325 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 19.915368 seconds
Rank=3, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.012172, per step: 0.000097
presamping
presamping takes 20.09575891494751
Rank=1, Graph loaded.
!!!!dist_homo_graph enumerate latency per epoch: 0.012108, per step: 0.000097
presamping
presamping takes 20.351794004440308

